  0%|          | 0/6654 [00:00<?, ?it/s]100%|██████████| 6654/6654 [00:00<00:00, 156037.68it/s]actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 128, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.03, 'early_stopping': 20, 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.027902841567993164 seconds.
Run epoch 1
Epoch 1 ends in 0.030698060989379883 seconds.
6654 sentences created
mode 1: time used = 0.05231213569641113
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 5: {'train_loss': '26.78453'}; time used = 0.3880171775817871s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 10: {'train_loss': '54.50397'}; time used = 0.29076433181762695s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 15: {'train_loss': '67.90235'}; time used = 0.39402198791503906s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 20: {'train_loss': '24.82365'}; time used = 0.31728386878967285s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 25: {'train_loss': '11.30777'}; time used = 0.3376600742340088s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 30: {'train_loss': '5.93427'}; time used = 0.38492417335510254s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 35: {'train_loss': '3.08504'}; time used = 0.40096044540405273s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 40: {'train_loss': '2.39884'}; time used = 0.42015647888183594s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 45: {'train_loss': '1.57803'}; time used = 0.40794968605041504s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 50: {'train_loss': '1.07309'}; time used = 0.40468645095825195s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 55: {'train_loss': '0.71209'}; time used = 0.28896403312683105s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 60: {'train_loss': '0.52110'}; time used = 0.315781831741333s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 65: {'train_loss': '0.41678'}; time used = 0.3959653377532959s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 70: {'train_loss': '0.33494'}; time used = 0.43607473373413086s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 75: {'train_loss': '0.28933'}; time used = 0.3796989917755127s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 80: {'train_loss': '0.23018'}; time used = 0.38831067085266113s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 85: {'train_loss': '0.19549'}; time used = 0.5024280548095703s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 90: {'train_loss': '0.18088'}; time used = 0.43668317794799805s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 95: {'train_loss': '0.16454'}; time used = 0.29137372970581055s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 100: {'train_loss': '0.14574'}; time used = 0.3239150047302246s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 105: {'train_loss': '0.13898'}; time used = 0.29975104331970215s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 110: {'train_loss': '0.12304'}; time used = 0.35085248947143555s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 115: {'train_loss': '0.11757'}; time used = 0.4027888774871826s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 120: {'train_loss': '0.11581'}; time used = 0.3352212905883789s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 125: {'train_loss': '0.10742'}; time used = 0.31265783309936523s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 130: {'train_loss': '0.09864'}; time used = 0.35819315910339355s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 135: {'train_loss': '0.10114'}; time used = 0.27821874618530273s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 140: {'train_loss': '0.10494'}; time used = 0.2793092727661133s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 145: {'train_loss': '0.09590'}; time used = 0.3340566158294678s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 150: {'train_loss': '0.08479'}; time used = 0.3504490852355957s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 155: {'train_loss': '0.09121'}; time used = 0.3773350715637207s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 160: {'train_loss': '0.08884'}; time used = 0.36953258514404297s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 165: {'train_loss': '0.08617'}; time used = 0.2749605178833008s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 170: {'train_loss': '0.07932'}; time used = 0.27141904830932617s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 175: {'train_loss': '0.07913'}; time used = 0.3093400001525879s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 180: {'train_loss': '0.07474'}; time used = 0.6417140960693359s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 185: {'train_loss': '0.07369'}; time used = 0.6814463138580322s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 190: {'train_loss': '0.07490'}; time used = 0.7857716083526611s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 195: {'train_loss': '0.07553'}; time used = 0.7907857894897461s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 200: {'train_loss': '0.07803'}; time used = 0.7944333553314209s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 205: {'train_loss': '0.07056'}; time used = 0.8879632949829102s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 210: {'train_loss': '0.07004'}; time used = 0.8374857902526855s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 215: {'train_loss': '0.07021'}; time used = 0.85298752784729s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 220: {'train_loss': '0.06796'}; time used = 1.0519611835479736s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 225: {'train_loss': '0.06575'}; time used = 1.433441162109375s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 230: {'train_loss': '0.06616'}; time used = 1.3417980670928955s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 235: {'train_loss': '0.06486'}; time used = 1.1981794834136963s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 240: {'train_loss': '0.06707'}; time used = 1.2279915809631348s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 245: {'train_loss': '0.06596'}; time used = 1.165705680847168s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 250: {'train_loss': '0.06198'}; time used = 1.078228235244751s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 255: {'train_loss': '0.06192'}; time used = 1.1920485496520996s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 260: {'train_loss': '0.06263'}; time used = 1.140122413635254s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 265: {'train_loss': '0.06281'}; time used = 1.1526377201080322s

torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 270: {'train_loss': '0.05985'}; time used = 1.3189682960510254s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 275: {'train_loss': '0.05725'}; time used = 0.8775091171264648s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 280: {'train_loss': '0.05722'}; time used = 1.1036889553070068s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 285: {'train_loss': '0.06060'}; time used = 1.1590228080749512s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 290: {'train_loss': '0.05870'}; time used = 0.890570878982544s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 295: {'train_loss': '0.05903'}; time used = 1.1171324253082275s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 300: {'train_loss': '0.05711'}; time used = 0.9521398544311523s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 305: {'train_loss': '0.05711'}; time used = 1.0573477745056152s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 310: {'train_loss': '0.05438'}; time used = 0.986457109451294s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 315: {'train_loss': '0.05620'}; time used = 1.0018584728240967s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 320: {'train_loss': '0.05674'}; time used = 1.117326021194458s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 325: {'train_loss': '0.05329'}; time used = 0.8596413135528564s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 330: {'train_loss': '0.05146'}; time used = 0.9662094116210938s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 335: {'train_loss': '0.05647'}; time used = 1.1574957370758057s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 340: {'train_loss': '0.05136'}; time used = 0.993931770324707s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 345: {'train_loss': '0.05173'}; time used = 1.1099810600280762s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 350: {'train_loss': '0.05236'}; time used = 0.9907550811767578s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 355: {'train_loss': '0.04950'}; time used = 0.982628583908081s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 360: {'train_loss': '0.04803'}; time used = 1.1109416484832764s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 365: {'train_loss': '0.05220'}; time used = 0.6797120571136475s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 370: {'train_loss': '0.04958'}; time used = 0.5615737438201904s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 375: {'train_loss': '0.05092'}; time used = 0.5490856170654297s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 380: {'train_loss': '0.05198'}; time used = 0.44069337844848633s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 385: {'train_loss': '0.05249'}; time used = 0.29634976387023926s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 390: {'train_loss': '0.04664'}; time used = 0.39235949516296387s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 395: {'train_loss': '0.04933'}; time used = 0.3547844886779785s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 400: {'train_loss': '0.04895'}; time used = 0.29717016220092773s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 405: {'train_loss': '0.04929'}; time used = 0.34869384765625s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 410: {'train_loss': '0.04909'}; time used = 0.27172064781188965s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 415: {'train_loss': '0.04811'}; time used = 0.3511524200439453s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 420: {'train_loss': '0.04877'}; time used = 0.26552248001098633s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 425: {'train_loss': '0.04847'}; time used = 0.27125120162963867s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 430: {'train_loss': '0.04818'}; time used = 0.2864522933959961s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 435: {'train_loss': '0.04799'}; time used = 0.28234338760375977s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 440: {'train_loss': '0.04689'}; time used = 0.2696816921234131s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 445: {'train_loss': '0.04662'}; time used = 0.271425724029541s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 450: {'train_loss': '0.04795'}; time used = 0.28357887268066406s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 455: {'train_loss': '0.04743'}; time used = 0.2803525924682617s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 460: {'train_loss': '0.04682'}; time used = 0.29959654808044434s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 465: {'train_loss': '0.04363'}; time used = 0.27537012100219727s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 470: {'train_loss': '0.04650'}; time used = 0.27954888343811035s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 475: {'train_loss': '0.04338'}; time used = 0.29421353340148926s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 480: {'train_loss': '0.04542'}; time used = 0.28719067573547363s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 485: {'train_loss': '0.04510'}; time used = 0.2757258415222168s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 490: {'train_loss': '0.04408'}; time used = 0.2803175449371338s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 495: {'train_loss': '0.04263'}; time used = 0.28182458877563477s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 500: {'train_loss': '0.04371'}; time used = 0.2907271385192871s
torch.int64
Finished training. Time used = 71.87432503700256.
Training classifier using 20.00% nodes...
{'micro': 0.6933085501858737, 'macro': 0.6287324475192585, 'samples': 0.7006010518407213, 'weighted': 0.6788384688035378}
  0%|          | 0/6654 [00:00<?, ?it/s] 91%|█████████ | 6048/6654 [00:00<00:00, 60476.60it/s]100%|██████████| 6654/6654 [00:00<00:00, 62151.67it/s]actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 128, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.001, 'early_stopping': 20, 'hiddens': [128], 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.07681107521057129 seconds.
Run epoch 1
Epoch 1 ends in 0.0931844711303711 seconds.
6654 sentences created
mode 1: time used = 0.14281082153320312
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 5: {'train_loss': '1.33690'}; time used = 0.8168647289276123s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 10: {'train_loss': '1.14905'}; time used = 0.8640754222869873s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 15: {'train_loss': '0.83659'}; time used = 0.7764797210693359s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 20: {'train_loss': '0.59698'}; time used = 0.7857465744018555s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 25: {'train_loss': '0.42922'}; time used = 0.7361013889312744s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 30: {'train_loss': '0.31582'}; time used = 0.79355788230896s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 35: {'train_loss': '0.23710'}; time used = 0.7578408718109131s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 40: {'train_loss': '0.19044'}; time used = 0.763573408126831s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 45: {'train_loss': '0.16063'}; time used = 0.8576295375823975s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 50: {'train_loss': '0.13431'}; time used = 0.8233222961425781s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 55: {'train_loss': '0.11718'}; time used = 0.5861008167266846s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 60: {'train_loss': '0.10806'}; time used = 0.2933773994445801s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 65: {'train_loss': '0.09441'}; time used = 0.32114100456237793s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 70: {'train_loss': '0.09721'}; time used = 0.2954583168029785s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 75: {'train_loss': '0.08066'}; time used = 0.3720395565032959s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 80: {'train_loss': '0.08340'}; time used = 0.292949914932251s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 85: {'train_loss': '0.07422'}; time used = 0.4848597049713135s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 90: {'train_loss': '0.07333'}; time used = 0.3584153652191162s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 95: {'train_loss': '0.06898'}; time used = 0.2925405502319336s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 100: {'train_loss': '0.06711'}; time used = 0.3203010559082031s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 105: {'train_loss': '0.06264'}; time used = 0.30809497833251953s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 110: {'train_loss': '0.06219'}; time used = 0.27576184272766113s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 115: {'train_loss': '0.05962'}; time used = 0.2884180545806885s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 120: {'train_loss': '0.05684'}; time used = 0.29358363151550293s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 125: {'train_loss': '0.05757'}; time used = 0.2810533046722412s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 130: {'train_loss': '0.05501'}; time used = 0.3850674629211426s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 135: {'train_loss': '0.05329'}; time used = 0.35045838356018066s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 140: {'train_loss': '0.05560'}; time used = 0.2708573341369629s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 145: {'train_loss': '0.05193'}; time used = 0.27695345878601074s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 150: {'train_loss': '0.05131'}; time used = 0.2697587013244629s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 155: {'train_loss': '0.05153'}; time used = 0.27083253860473633s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 160: {'train_loss': '0.05266'}; time used = 0.2645587921142578s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 165: {'train_loss': '0.05030'}; time used = 0.30467677116394043s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 170: {'train_loss': '0.05012'}; time used = 0.26895880699157715s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 175: {'train_loss': '0.04921'}; time used = 0.384904146194458s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 180: {'train_loss': '0.04852'}; time used = 0.2731599807739258s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 185: {'train_loss': '0.04425'}; time used = 0.28228306770324707s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 190: {'train_loss': '0.04643'}; time used = 0.47653698921203613s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 195: {'train_loss': '0.04496'}; time used = 0.2729024887084961s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 200: {'train_loss': '0.04693'}; time used = 0.2719290256500244s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 205: {'train_loss': '0.04498'}; time used = 0.3067600727081299s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 210: {'train_loss': '0.04380'}; time used = 0.33533406257629395s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 215: {'train_loss': '0.04306'}; time used = 0.4030592441558838s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 220: {'train_loss': '0.04468'}; time used = 0.2865478992462158s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 225: {'train_loss': '0.04322'}; time used = 0.2696850299835205s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 230: {'train_loss': '0.04251'}; time used = 0.27294230461120605s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 235: {'train_loss': '0.04358'}; time used = 0.31459474563598633s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 240: {'train_loss': '0.04172'}; time used = 0.28057217597961426s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 245: {'train_loss': '0.04263'}; time used = 0.2764706611633301s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 250: {'train_loss': '0.04330'}; time used = 0.3004457950592041s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 255: {'train_loss': '0.04267'}; time used = 0.30921006202697754s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 260: {'train_loss': '0.04498'}; time used = 0.2808363437652588s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 265: {'train_loss': '0.03962'}; time used = 0.3118457794189453s

torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 270: {'train_loss': '0.03861'}; time used = 0.33161115646362305s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 275: {'train_loss': '0.04021'}; time used = 0.29233884811401367s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 280: {'train_loss': '0.03990'}; time used = 0.41887402534484863s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 285: {'train_loss': '0.04084'}; time used = 0.2834792137145996s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 290: {'train_loss': '0.03829'}; time used = 0.3062126636505127s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 295: {'train_loss': '0.04003'}; time used = 0.2813384532928467s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 300: {'train_loss': '0.03905'}; time used = 0.2845115661621094s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 305: {'train_loss': '0.03849'}; time used = 0.278256893157959s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 310: {'train_loss': '0.03906'}; time used = 0.4076831340789795s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 315: {'train_loss': '0.03774'}; time used = 0.3803732395172119s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 320: {'train_loss': '0.03832'}; time used = 0.3395559787750244s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 325: {'train_loss': '0.03840'}; time used = 0.2753770351409912s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 330: {'train_loss': '0.03779'}; time used = 0.3698601722717285s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 335: {'train_loss': '0.03679'}; time used = 0.3713374137878418s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 340: {'train_loss': '0.03626'}; time used = 0.30069780349731445s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 345: {'train_loss': '0.03706'}; time used = 0.29390501976013184s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 350: {'train_loss': '0.03838'}; time used = 0.29559922218322754s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 355: {'train_loss': '0.03858'}; time used = 0.35311341285705566s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 360: {'train_loss': '0.03971'}; time used = 0.3806931972503662s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 365: {'train_loss': '0.03854'}; time used = 0.292374849319458s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 370: {'train_loss': '0.03679'}; time used = 0.29172587394714355s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 375: {'train_loss': '0.03684'}; time used = 0.31066322326660156s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 380: {'train_loss': '0.03918'}; time used = 0.3240201473236084s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 385: {'train_loss': '0.03848'}; time used = 0.28267550468444824s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 390: {'train_loss': '0.03733'}; time used = 0.3071281909942627s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 395: {'train_loss': '0.03734'}; time used = 0.2894139289855957s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 400: {'train_loss': '0.03620'}; time used = 0.30019688606262207s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 405: {'train_loss': '0.03706'}; time used = 0.31525373458862305s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 410: {'train_loss': '0.03755'}; time used = 0.2827565670013428s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 415: {'train_loss': '0.03876'}; time used = 0.29468870162963867s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 420: {'train_loss': '0.03620'}; time used = 0.2969846725463867s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 425: {'train_loss': '0.03736'}; time used = 0.2804577350616455s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 430: {'train_loss': '0.03582'}; time used = 0.3122260570526123s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 435: {'train_loss': '0.03517'}; time used = 0.3684532642364502s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 440: {'train_loss': '0.03707'}; time used = 0.31556105613708496s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 445: {'train_loss': '0.03469'}; time used = 0.38259387016296387s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 450: {'train_loss': '0.03558'}; time used = 0.2884030342102051s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 455: {'train_loss': '0.03806'}; time used = 0.2988429069519043s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 460: {'train_loss': '0.03515'}; time used = 0.2778501510620117s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 465: {'train_loss': '0.03521'}; time used = 0.2749607563018799s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 470: {'train_loss': '0.03404'}; time used = 0.28020548820495605s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 475: {'train_loss': '0.03347'}; time used = 0.2712113857269287s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 480: {'train_loss': '0.03524'}; time used = 0.325498104095459s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 485: {'train_loss': '0.03480'}; time used = 0.27859997749328613s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 490: {'train_loss': '0.03551'}; time used = 0.26500439643859863s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 495: {'train_loss': '0.03494'}; time used = 0.41916465759277344s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 500: {'train_loss': '0.03526'}; time used = 0.39850306510925293s
torch.int64
Finished training. Time used = 48.13832330703735.
Training classifier using 20.00% nodes...
{'micro': 0.6613382899628253, 'macro': 0.5974484699334712, 'samples': 0.6682945154019534, 'weighted': 0.6479078874014057}
  0%|          | 0/6654 [00:00<?, ?it/s]100%|██████████| 6654/6654 [00:00<00:00, 194008.50it/s]
Traceback (most recent call last):
  File "/usr/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/duyufeng/OpenNE/src/openne/__main__.py", line 265, in <module>
    main(parse_args())
  File "/home/duyufeng/OpenNE/src/openne/__main__.py", line 249, in main
    res = task.train(model, graph)  # train
  File "/home/duyufeng/OpenNE/src/openne/tasks/tasks.py", line 35, in train
    res = model(graph, **self.train_kwargs())
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/duyufeng/OpenNE/src/openne/models/models.py", line 236, in forward
    self.embeddings = self.train_model(graph, step=i, **kwargs)
  File "/home/duyufeng/OpenNE/src/openne/models/ss_nodemodel.py", line 111, in train_model
    output, train_loss, __ = self.evaluate()
  File "/home/duyufeng/OpenNE/src/openne/models/ss_nodemodel.py", line 153, in evaluate
    loss.backward()
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/tensor.py", line 185, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/autograd/__init__.py", line 127, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA out of memory. Tried to allocate 5.69 GiB (GPU 5; 10.76 GiB total capacity; 286.22 MiB already allocated; 4.81 GiB free; 306.00 MiB reserved in total by PyTorch)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:272 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7ff1fb68f1e2 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x1e64b (0x7ff20bab764b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #2: <unknown function> + 0x1f464 (0x7ff20bab8464 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #3: <unknown function> + 0x1faa1 (0x7ff20bab8aa1 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #4: at::native::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0x11e (0x7fefa987890e in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #5: <unknown function> + 0xf33949 (0x7fefa7cb2949 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xf4d777 (0x7fefa7ccc777 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0x10e9c7d (0x7fefe2a68c7d in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #8: <unknown function> + 0x10e9f97 (0x7fefe2a68f97 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #9: at::empty(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0xfa (0x7fefe2b73a1a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::TensorIterator::allocate_outputs() + 0x378 (0x7fefe28034f8 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::TensorIterator::build(at::TensorIteratorConfig&) + 0x1e6 (0x7fefe2805166 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #12: at::TensorIterator::TensorIterator(at::TensorIteratorConfig&) + 0xdd (0x7fefe280565d in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #13: at::TensorIterator::binary_op(at::Tensor&, at::Tensor const&, at::Tensor const&, bool) + 0x14a (0x7fefe280580a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #14: at::native::mul(at::Tensor const&, at::Tensor const&) + 0x47 (0x7fefe2542eb7 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0xf22b40 (0x7fefa7ca1b40 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #16: <unknown function> + 0xa56530 (0x7fefe23d5530 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #17: at::Tensor c10::Dispatcher::call<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, at::Tensor const&)> const&, at::Tensor const&, at::Tensor const&) const + 0xbc (0x7fefe2bbd81c in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #18: at::mul(at::Tensor const&, at::Tensor const&) + 0x4b (0x7fefe2b0e82b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #19: <unknown function> + 0xcc6952 (0x7fefe2645952 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #20: at::native::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0xdba (0x7fefe2646f4a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #21: <unknown function> + 0x129b8c0 (0x7fefe2c1a8c0 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #22: <unknown function> + 0x12c508b (0x7fefe2c4408b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #23: at::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0x1d7 (0x7fefe2b6b337 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #24: <unknown function> + 0x2dfa205 (0x7fefe4779205 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #25: <unknown function> + 0x12c508b (0x7fefe2c4408b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #26: at::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0x1d7 (0x7fefe2b6b337 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #27: torch::autograd::generated::TrilinearBackward::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&) + 0x6a8 (0x7fefe46d8f78 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #28: <unknown function> + 0x3375bb7 (0x7fefe4cf4bb7 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #29: torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&) + 0x1400 (0x7fefe4cf0400 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #30: torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&) + 0x451 (0x7fefe4cf0fa1 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #31: torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x89 (0x7fefe4ce9119 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #32: torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x4a (0x7ff18c4364ba in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_python.so)
frame #33: <unknown function> + 0xbd6df (0x7ff20c5be6df in /usr/lib/x86_64-linux-gnu/libstdc++.so.6)
frame #34: <unknown function> + 0x76db (0x7ff2106196db in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #35: clone + 0x3f (0x7ff21095271f in /lib/x86_64-linux-gnu/libc.so.6)

actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 128, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.01, 'early_stopping': 20, 'hiddens': [128], 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.020776748657226562 seconds.
Run epoch 1
Epoch 1 ends in 0.01988816261291504 seconds.
6654 sentences created
mode 1: time used = 0.04586172103881836
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
  0%|          | 0/6654 [00:00<?, ?it/s]100%|██████████| 6654/6654 [00:00<00:00, 218766.35it/s]
actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 128, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.02, 'early_stopping': 20, 'hiddens': [128], 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.01779484748840332 seconds.
Run epoch 1
Epoch 1 ends in 0.017187118530273438 seconds.
6654 sentences created
mode 1: time used = 0.037699222564697266
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 5: {'train_loss': '1.38703'}; time used = 0.3099548816680908s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 10: {'train_loss': '1.38501'}; time used = 0.2838928699493408s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 15: {'train_loss': '1.39086'}; time used = 0.27872753143310547s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 20: {'train_loss': '1.39181'}; time used = 0.28059935569763184s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 25: {'train_loss': '1.38924'}; time used = 0.28274035453796387s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 30: {'train_loss': '1.38836'}; time used = 0.2837212085723877s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 35: {'train_loss': '1.38764'}; time used = 0.29117655754089355s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 40: {'train_loss': '1.38708'}; time used = 0.27706265449523926s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 45: {'train_loss': '1.38670'}; time used = 0.28497314453125s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 50: {'train_loss': '1.38647'}; time used = 0.2827920913696289s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 55: {'train_loss': '1.38635'}; time used = 0.28736233711242676s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 60: {'train_loss': '1.38631'}; time used = 0.2712090015411377s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 65: {'train_loss': '1.38630'}; time used = 0.2860691547393799s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 70: {'train_loss': '1.38630'}; time used = 0.2904348373413086s
torch.int64
Early stopping condition satisfied. Abort training.
torch.int64
Finished training. Time used = 7.066173553466797.
Training classifier using 20.00% nodes...
{'micro': 0.19442379182156136, 'macro': 0.05473574045002617, 'samples': 0.19646882043576258, 'weighted': 0.06486433290490261}
  0%|          | 0/6654 [00:00<?, ?it/s]100%|██████████| 6654/6654 [00:00<00:00, 98741.18it/s]
actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 128, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.03, 'early_stopping': 20, 'hiddens': [128], 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.055299997329711914 seconds.
Run epoch 1
Epoch 1 ends in 0.03638601303100586 seconds.
6654 sentences created
mode 1: time used = 0.08284282684326172
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 5: {'train_loss': '1.55973'}; time used = 0.37044620513916016s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 10: {'train_loss': '1.39012'}; time used = 0.4063289165496826s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 15: {'train_loss': '1.39035'}; time used = 0.3864421844482422s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 20: {'train_loss': '1.38971'}; time used = 0.5560777187347412s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 25: {'train_loss': '1.38878'}; time used = 0.6297593116760254s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 30: {'train_loss': '1.38787'}; time used = 0.43851661682128906s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 35: {'train_loss': '1.38715'}; time used = 0.45769810676574707s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 40: {'train_loss': '1.38668'}; time used = 0.43117785453796387s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 45: {'train_loss': '1.38642'}; time used = 0.4273366928100586s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 50: {'train_loss': '1.38632'}; time used = 0.4347374439239502s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 55: {'train_loss': '1.38629'}; time used = 0.43541407585144043s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 60: {'train_loss': '1.38630'}; time used = 0.3398139476776123s
Early stopping condition satisfied. Abort training.
torch.int64
Finished training. Time used = 18.512492895126343.
Training classifier using 20.00% nodes...
{'micro': 0.19442379182156136, 'macro': 0.05473574045002617, 'samples': 0.19646882043576258, 'weighted': 0.06486433290490261}
  0%|          | 0/6654 [00:00<?, ?it/s]100%|██████████| 6654/6654 [00:00<00:00, 118081.92it/s]actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 128, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.001, 'early_stopping': 20, 'hiddens': [128, 128], 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.04978823661804199 seconds.
Run epoch 1
Epoch 1 ends in 0.05100536346435547 seconds.
6654 sentences created
mode 1: time used = 0.06878161430358887
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 5: {'train_loss': '1.35468'}; time used = 0.5576417446136475s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 10: {'train_loss': '1.17777'}; time used = 0.9228053092956543s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 15: {'train_loss': '0.84341'}; time used = 0.8410067558288574s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 20: {'train_loss': '0.59427'}; time used = 0.8674051761627197s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 25: {'train_loss': '0.43442'}; time used = 0.8563122749328613s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 30: {'train_loss': '0.33162'}; time used = 0.9642765522003174s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 35: {'train_loss': '0.25958'}; time used = 0.8909800052642822s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 40: {'train_loss': '0.20657'}; time used = 0.7468204498291016s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 45: {'train_loss': '0.17497'}; time used = 0.7394001483917236s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 50: {'train_loss': '0.15419'}; time used = 0.8293662071228027s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 55: {'train_loss': '0.13306'}; time used = 0.6969954967498779s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 60: {'train_loss': '0.12277'}; time used = 0.7831099033355713s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 65: {'train_loss': '0.10980'}; time used = 0.6848626136779785s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 70: {'train_loss': '0.10070'}; time used = 0.8241581916809082s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 75: {'train_loss': '0.09456'}; time used = 0.8172132968902588s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 80: {'train_loss': '0.08866'}; time used = 0.8123581409454346s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 85: {'train_loss': '0.08484'}; time used = 0.678992748260498s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 90: {'train_loss': '0.08375'}; time used = 0.862558126449585s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 95: {'train_loss': '0.09888'}; time used = 0.7553045749664307s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 100: {'train_loss': '0.23649'}; time used = 0.7529888153076172s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 105: {'train_loss': '0.47828'}; time used = 0.8436050415039062s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 110: {'train_loss': '0.16297'}; time used = 0.785231351852417s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 115: {'train_loss': '0.14595'}; time used = 0.8558065891265869s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 120: {'train_loss': '0.11308'}; time used = 0.7242300510406494s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 125: {'train_loss': '0.10426'}; time used = 0.631382942199707s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 130: {'train_loss': '0.09704'}; time used = 0.7524726390838623s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 135: {'train_loss': '0.08496'}; time used = 0.7429890632629395s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 140: {'train_loss': '0.07938'}; time used = 0.687039852142334s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 145: {'train_loss': '0.07362'}; time used = 0.7080013751983643s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 150: {'train_loss': '0.06767'}; time used = 0.67881178855896s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 155: {'train_loss': '0.06824'}; time used = 0.7719881534576416s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 160: {'train_loss': '0.06505'}; time used = 0.6642258167266846s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 165: {'train_loss': '0.06336'}; time used = 0.6842443943023682s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 170: {'train_loss': '0.06061'}; time used = 0.638023853302002s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 175: {'train_loss': '0.06075'}; time used = 0.6408946514129639s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 180: {'train_loss': '0.05888'}; time used = 0.6406586170196533s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 185: {'train_loss': '0.05843'}; time used = 0.5864264965057373s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 190: {'train_loss': '0.05735'}; time used = 0.36505842208862305s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 195: {'train_loss': '0.05373'}; time used = 0.3545191287994385s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 200: {'train_loss': '0.05800'}; time used = 0.33775925636291504s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 205: {'train_loss': '0.05522'}; time used = 0.40634918212890625s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 210: {'train_loss': '0.05607'}; time used = 0.34665656089782715s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 215: {'train_loss': '0.05471'}; time used = 0.4124584197998047s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 220: {'train_loss': '0.05506'}; time used = 0.3731362819671631s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 225: {'train_loss': '0.05168'}; time used = 0.4168069362640381s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 230: {'train_loss': '0.05189'}; time used = 0.3153986930847168s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 235: {'train_loss': '0.05185'}; time used = 0.3070676326751709s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 240: {'train_loss': '0.05168'}; time used = 0.4334583282470703s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 245: {'train_loss': '0.04896'}; time used = 0.5270686149597168s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 250: {'train_loss': '0.05175'}; time used = 0.4085671901702881s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 255: {'train_loss': '0.05083'}; time used = 0.28819990158081055s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 260: {'train_loss': '0.05038'}; time used = 0.2885255813598633s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 265: {'train_loss': '0.04808'}; time used = 0.33690547943115234s

torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 270: {'train_loss': '0.04871'}; time used = 0.3495497703552246s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 275: {'train_loss': '0.04757'}; time used = 0.46683406829833984s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 280: {'train_loss': '0.04738'}; time used = 0.34538698196411133s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 285: {'train_loss': '0.04689'}; time used = 0.32918310165405273s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 290: {'train_loss': '0.04796'}; time used = 0.38907718658447266s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 295: {'train_loss': '0.04625'}; time used = 0.3480865955352783s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 300: {'train_loss': '0.04561'}; time used = 0.3938150405883789s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 305: {'train_loss': '0.04591'}; time used = 0.37972259521484375s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 310: {'train_loss': '0.04640'}; time used = 0.3746175765991211s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 315: {'train_loss': '0.04591'}; time used = 0.332017183303833s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 320: {'train_loss': '0.04755'}; time used = 0.45224905014038086s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 325: {'train_loss': '0.04633'}; time used = 0.3319878578186035s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 330: {'train_loss': '0.04347'}; time used = 0.3591902256011963s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 335: {'train_loss': '0.04413'}; time used = 0.43903636932373047s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 340: {'train_loss': '0.04499'}; time used = 0.3667106628417969s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 345: {'train_loss': '0.04783'}; time used = 0.43736767768859863s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 350: {'train_loss': '0.04316'}; time used = 0.33307766914367676s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 355: {'train_loss': '0.04438'}; time used = 0.34979772567749023s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 360: {'train_loss': '0.04373'}; time used = 0.34633779525756836s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 365: {'train_loss': '0.04411'}; time used = 0.4003283977508545s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 370: {'train_loss': '0.04184'}; time used = 0.30701398849487305s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 375: {'train_loss': '0.04234'}; time used = 0.4450643062591553s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 380: {'train_loss': '0.04254'}; time used = 0.42407989501953125s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 385: {'train_loss': '0.04281'}; time used = 0.3582625389099121s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 390: {'train_loss': '0.04256'}; time used = 0.3392155170440674s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 395: {'train_loss': '0.04243'}; time used = 0.37282252311706543s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 400: {'train_loss': '0.04296'}; time used = 0.3183596134185791s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 405: {'train_loss': '0.04265'}; time used = 0.3197460174560547s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 410: {'train_loss': '0.04076'}; time used = 0.4618833065032959s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 415: {'train_loss': '0.04217'}; time used = 0.4046804904937744s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 420: {'train_loss': '0.04297'}; time used = 0.3249936103820801s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 425: {'train_loss': '0.04157'}; time used = 0.44205760955810547s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 430: {'train_loss': '0.04214'}; time used = 0.4566769599914551s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 435: {'train_loss': '0.04185'}; time used = 0.3585505485534668s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 440: {'train_loss': '0.04125'}; time used = 0.2992827892303467s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 445: {'train_loss': '0.04007'}; time used = 0.3924562931060791s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 450: {'train_loss': '0.04168'}; time used = 0.4145944118499756s
torch.int64
Early stopping condition satisfied. Abort training.
torch.int64
Finished training. Time used = 67.39511227607727.
Training classifier using 20.00% nodes...
{'micro': 0.6472118959107807, 'macro': 0.5604063089069699, 'samples': 0.6540195341848234, 'weighted': 0.6222010794814262}
  0%|          | 0/6654 [00:00<?, ?it/s]100%|██████████| 6654/6654 [00:00<00:00, 122359.69it/s]actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 128, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.01, 'early_stopping': 20, 'hiddens': [128, 128], 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.03563857078552246 seconds.
Run epoch 1
Epoch 1 ends in 0.03480076789855957 seconds.
6654 sentences created
mode 1: time used = 0.06792521476745605
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 5: {'train_loss': '1.92347'}; time used = 0.36037302017211914s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 10: {'train_loss': '1.38317'}; time used = 0.37406134605407715s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 15: {'train_loss': '1.36584'}; time used = 0.28754353523254395s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 20: {'train_loss': '1.27648'}; time used = 0.46695590019226074s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 25: {'train_loss': '1.16501'}; time used = 0.36180710792541504s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 30: {'train_loss': '1.10048'}; time used = 0.3856937885284424s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 35: {'train_loss': '1.03574'}; time used = 0.30054378509521484s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 40: {'train_loss': '1.00606'}; time used = 0.35078907012939453s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 45: {'train_loss': '0.98565'}; time used = 0.2808675765991211s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 50: {'train_loss': '0.97853'}; time used = 0.2932424545288086s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 55: {'train_loss': '0.95852'}; time used = 0.3071448802947998s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 60: {'train_loss': '0.95728'}; time used = 0.29121875762939453s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 65: {'train_loss': '0.95297'}; time used = 0.36751437187194824s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 70: {'train_loss': '0.94200'}; time used = 0.3733968734741211s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 75: {'train_loss': '0.94714'}; time used = 0.3410830497741699s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 80: {'train_loss': '0.94377'}; time used = 0.3647007942199707s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 85: {'train_loss': '0.87883'}; time used = 0.3369009494781494s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 90: {'train_loss': '0.79387'}; time used = 0.3250422477722168s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 95: {'train_loss': '0.80071'}; time used = 0.41617894172668457s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 100: {'train_loss': '0.87269'}; time used = 0.3070375919342041s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 105: {'train_loss': '0.75159'}; time used = 0.36656808853149414s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 110: {'train_loss': '0.70847'}; time used = 0.3556051254272461s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 115: {'train_loss': '0.71912'}; time used = 0.46042943000793457s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 120: {'train_loss': '0.67831'}; time used = 0.47440457344055176s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 125: {'train_loss': '0.62252'}; time used = 0.4782869815826416s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 130: {'train_loss': '0.58503'}; time used = 0.4556467533111572s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 135: {'train_loss': '0.62367'}; time used = 0.4201846122741699s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 140: {'train_loss': '0.55975'}; time used = 0.3184506893157959s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 145: {'train_loss': '0.52381'}; time used = 0.3468611240386963s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 150: {'train_loss': '0.50286'}; time used = 0.37107181549072266s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 155: {'train_loss': '0.53325'}; time used = 0.3980140686035156s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 160: {'train_loss': '0.63940'}; time used = 0.3877286911010742s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 165: {'train_loss': '0.60136'}; time used = 0.42958831787109375s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 170: {'train_loss': '0.56137'}; time used = 0.39128708839416504s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 175: {'train_loss': '0.51324'}; time used = 0.48887062072753906s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 180: {'train_loss': '0.46268'}; time used = 0.5566539764404297s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 185: {'train_loss': '0.43269'}; time used = 0.4639322757720947s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 190: {'train_loss': '0.40227'}; time used = 0.48551321029663086s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 195: {'train_loss': '0.38363'}; time used = 0.4365808963775635s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 200: {'train_loss': '0.39399'}; time used = 0.4001290798187256s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 205: {'train_loss': '0.57529'}; time used = 0.30115556716918945s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 210: {'train_loss': '0.50508'}; time used = 0.4141194820404053s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 215: {'train_loss': '0.47217'}; time used = 0.40741682052612305s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 220: {'train_loss': '0.43541'}; time used = 0.4294168949127197s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 225: {'train_loss': '0.39085'}; time used = 0.3452272415161133s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 230: {'train_loss': '0.36089'}; time used = 0.364727258682251s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 235: {'train_loss': '0.33115'}; time used = 0.2903439998626709s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 240: {'train_loss': '0.34681'}; time used = 0.4784200191497803s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 245: {'train_loss': '0.32444'}; time used = 0.3848865032196045s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 250: {'train_loss': '0.37191'}; time used = 0.5101885795593262s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 255: {'train_loss': '0.36459'}; time used = 0.4731442928314209s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 260: {'train_loss': '0.36985'}; time used = 0.3282597064971924s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 265: {'train_loss': '0.32926'}; time used = 0.45931124687194824s

torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 270: {'train_loss': '0.29850'}; time used = 0.4707169532775879s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 275: {'train_loss': '0.27665'}; time used = 0.43997693061828613s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 280: {'train_loss': '0.25591'}; time used = 0.32973289489746094s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 285: {'train_loss': '0.24509'}; time used = 0.45461487770080566s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 290: {'train_loss': '0.29344'}; time used = 0.4201807975769043s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 295: {'train_loss': '0.35749'}; time used = 0.32201147079467773s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 300: {'train_loss': '0.33705'}; time used = 0.39977502822875977s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 305: {'train_loss': '0.29853'}; time used = 0.4390828609466553s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 310: {'train_loss': '0.27425'}; time used = 0.3796572685241699s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 315: {'train_loss': '0.25200'}; time used = 0.38672399520874023s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 320: {'train_loss': '0.23807'}; time used = 0.34807920455932617s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 325: {'train_loss': '0.22492'}; time used = 0.5190653800964355s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 330: {'train_loss': '0.21366'}; time used = 0.47679781913757324s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 335: {'train_loss': '0.20786'}; time used = 0.39092397689819336s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 340: {'train_loss': '0.20134'}; time used = 0.3557591438293457s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 345: {'train_loss': '0.19565'}; time used = 0.3836050033569336s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 350: {'train_loss': '0.19131'}; time used = 0.4863753318786621s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 355: {'train_loss': '0.24474'}; time used = 0.4061543941497803s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 360: {'train_loss': '0.41048'}; time used = 0.41847872734069824s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 365: {'train_loss': '0.47801'}; time used = 0.35851144790649414s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 370: {'train_loss': '0.38089'}; time used = 0.41904330253601074s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 375: {'train_loss': '0.34260'}; time used = 0.3570821285247803s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 380: {'train_loss': '0.30609'}; time used = 0.41765475273132324s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 385: {'train_loss': '0.27582'}; time used = 0.4185924530029297s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 390: {'train_loss': '0.24745'}; time used = 0.29601120948791504s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 395: {'train_loss': '0.23222'}; time used = 0.3482503890991211s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 400: {'train_loss': '0.21925'}; time used = 0.3614161014556885s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 405: {'train_loss': '0.21200'}; time used = 0.29038405418395996s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 410: {'train_loss': '0.19953'}; time used = 0.36307215690612793s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 415: {'train_loss': '0.19348'}; time used = 0.32787442207336426s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 420: {'train_loss': '0.18867'}; time used = 0.31612205505371094s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 425: {'train_loss': '0.18379'}; time used = 0.3681478500366211s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 430: {'train_loss': '0.17736'}; time used = 0.5155336856842041s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 435: {'train_loss': '0.17790'}; time used = 0.34648966789245605s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 440: {'train_loss': '0.17325'}; time used = 0.45427370071411133s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 445: {'train_loss': '0.16744'}; time used = 0.34227609634399414s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 450: {'train_loss': '0.16788'}; time used = 0.42138028144836426s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 455: {'train_loss': '0.16597'}; time used = 0.3707125186920166s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 460: {'train_loss': '0.16308'}; time used = 0.5694704055786133s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 465: {'train_loss': '0.22902'}; time used = 0.4720602035522461s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 470: {'train_loss': '0.30322'}; time used = 0.4253063201904297s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 475: {'train_loss': '0.39609'}; time used = 0.417616605758667s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 480: {'train_loss': '0.29858'}; time used = 0.4678652286529541s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 485: {'train_loss': '0.27778'}; time used = 0.41824960708618164s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 490: {'train_loss': '0.24891'}; time used = 0.5581653118133545s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 495: {'train_loss': '0.23034'}; time used = 0.4168071746826172s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 500: {'train_loss': '0.20960'}; time used = 0.5221858024597168s
torch.int64
Finished training. Time used = 46.72847104072571.
Training classifier using 20.00% nodes...
{'micro': 0.47806691449814126, 'macro': 0.4013633089685409, 'samples': 0.4830954169797145, 'weighted': 0.4516524234447211}
  0%|          | 0/6654 [00:00<?, ?it/s]100%|██████████| 6654/6654 [00:00<00:00, 197000.75it/s]actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 128, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.02, 'early_stopping': 20, 'hiddens': [128, 128], 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.023009300231933594 seconds.
Run epoch 1
Epoch 1 ends in 0.02112889289855957 seconds.
6654 sentences created
mode 1: time used = 0.04236555099487305
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 5: {'train_loss': '1.42879'}; time used = 0.3183295726776123s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 10: {'train_loss': '1.38500'}; time used = 0.4251749515533447s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 15: {'train_loss': '1.38609'}; time used = 0.33904194831848145s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 20: {'train_loss': '1.36957'}; time used = 0.4022500514984131s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 25: {'train_loss': '1.35203'}; time used = 0.2990570068359375s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 30: {'train_loss': '1.34126'}; time used = 0.37514424324035645s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 35: {'train_loss': '1.33067'}; time used = 0.36829543113708496s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 40: {'train_loss': '1.32384'}; time used = 0.2924001216888428s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 45: {'train_loss': '1.32096'}; time used = 0.33397912979125977s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 50: {'train_loss': '1.31557'}; time used = 0.30406975746154785s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 55: {'train_loss': '1.30916'}; time used = 0.2899017333984375s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 60: {'train_loss': '1.29816'}; time used = 0.34601283073425293s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 65: {'train_loss': '1.28175'}; time used = 0.32076334953308105s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 70: {'train_loss': '1.26595'}; time used = 0.3904845714569092s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 75: {'train_loss': '1.25784'}; time used = 0.33280324935913086s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 80: {'train_loss': '1.25676'}; time used = 0.4079551696777344s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 85: {'train_loss': '1.19777'}; time used = 0.3155837059020996s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 90: {'train_loss': '1.25271'}; time used = 0.2966439723968506s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 95: {'train_loss': '1.20048'}; time used = 0.307145357131958s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 100: {'train_loss': '1.14205'}; time used = 0.2843313217163086s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 105: {'train_loss': '1.07808'}; time used = 0.3203132152557373s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 110: {'train_loss': '0.99606'}; time used = 0.3667106628417969s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 115: {'train_loss': '0.95706'}; time used = 0.32359910011291504s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 120: {'train_loss': '0.92591'}; time used = 0.4038398265838623s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 125: {'train_loss': '0.89482'}; time used = 0.2806262969970703s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 130: {'train_loss': '0.89052'}; time used = 0.3021245002746582s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 135: {'train_loss': '0.85668'}; time used = 0.29473209381103516s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 140: {'train_loss': '0.84720'}; time used = 0.3086128234863281s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 145: {'train_loss': '0.95270'}; time used = 0.28547143936157227s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 150: {'train_loss': '0.93199'}; time used = 0.3104686737060547s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 155: {'train_loss': '0.93413'}; time used = 0.3436706066131592s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 160: {'train_loss': '0.94096'}; time used = 0.4078385829925537s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 165: {'train_loss': '0.88151'}; time used = 0.35345911979675293s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 170: {'train_loss': '0.83616'}; time used = 0.2868325710296631s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 175: {'train_loss': '0.81491'}; time used = 0.43422579765319824s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 180: {'train_loss': '0.80723'}; time used = 0.3608565330505371s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 185: {'train_loss': '0.79230'}; time used = 0.4642786979675293s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 190: {'train_loss': '0.78311'}; time used = 0.3085041046142578s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 195: {'train_loss': '0.77214'}; time used = 0.41407203674316406s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 200: {'train_loss': '0.81462'}; time used = 0.2980654239654541s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 205: {'train_loss': '0.79788'}; time used = 0.5168757438659668s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 210: {'train_loss': '0.78148'}; time used = 0.4078226089477539s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 215: {'train_loss': '0.76779'}; time used = 0.33507394790649414s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 220: {'train_loss': '0.75226'}; time used = 0.44075584411621094s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 225: {'train_loss': '0.73822'}; time used = 0.3792307376861572s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 230: {'train_loss': '0.75928'}; time used = 0.27622413635253906s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 235: {'train_loss': '0.87155'}; time used = 0.2771718502044678s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 240: {'train_loss': '0.87083'}; time used = 0.37735724449157715s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 245: {'train_loss': '0.79353'}; time used = 0.30295324325561523s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 250: {'train_loss': '0.76669'}; time used = 0.2911350727081299s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 255: {'train_loss': '0.75070'}; time used = 0.3154423236846924s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 260: {'train_loss': '0.73867'}; time used = 0.37424659729003906s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 265: {'train_loss': '0.71595'}; time used = 0.289384126663208s

torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 270: {'train_loss': '0.83431'}; time used = 0.274031400680542s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 275: {'train_loss': '0.75873'}; time used = 0.2850964069366455s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 280: {'train_loss': '0.75007'}; time used = 0.30056238174438477s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 285: {'train_loss': '0.93329'}; time used = 0.3748292922973633s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 290: {'train_loss': '0.86335'}; time used = 0.39626312255859375s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 295: {'train_loss': '0.77806'}; time used = 0.365736722946167s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 300: {'train_loss': '0.74553'}; time used = 0.2797672748565674s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 305: {'train_loss': '0.72496'}; time used = 0.3406074047088623s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 310: {'train_loss': '0.70911'}; time used = 0.3264174461364746s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 315: {'train_loss': '0.69699'}; time used = 0.29676318168640137s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 320: {'train_loss': '0.68758'}; time used = 0.30189990997314453s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 325: {'train_loss': '0.67895'}; time used = 0.2854795455932617s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 330: {'train_loss': '0.67074'}; time used = 0.27532219886779785s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 335: {'train_loss': '0.65434'}; time used = 0.3375058174133301s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 340: {'train_loss': '0.63677'}; time used = 0.3213462829589844s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 345: {'train_loss': '0.65512'}; time used = 0.3987102508544922s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 350: {'train_loss': '0.67932'}; time used = 0.3056471347808838s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 355: {'train_loss': '0.67716'}; time used = 0.3207523822784424s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 360: {'train_loss': '0.63430'}; time used = 0.35022616386413574s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 365: {'train_loss': '0.68657'}; time used = 0.3341686725616455s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 370: {'train_loss': '0.64339'}; time used = 0.39066600799560547s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 375: {'train_loss': '0.61285'}; time used = 0.3457455635070801s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 380: {'train_loss': '0.59778'}; time used = 0.35851263999938965s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 385: {'train_loss': '0.58636'}; time used = 0.30200815200805664s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 390: {'train_loss': '0.57871'}; time used = 0.3002305030822754s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 395: {'train_loss': '0.67100'}; time used = 0.3619246482849121s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 400: {'train_loss': '0.65765'}; time used = 0.3489086627960205s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 405: {'train_loss': '0.61618'}; time used = 0.4288043975830078s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 410: {'train_loss': '0.59222'}; time used = 0.42716383934020996s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 415: {'train_loss': '0.64283'}; time used = 0.45717859268188477s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 420: {'train_loss': '0.68176'}; time used = 0.3969767093658447s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 425: {'train_loss': '0.58957'}; time used = 0.354032039642334s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 430: {'train_loss': '0.58164'}; time used = 0.27736401557922363s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 435: {'train_loss': '0.56237'}; time used = 0.29895544052124023s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 440: {'train_loss': '0.56150'}; time used = 0.31156182289123535s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 445: {'train_loss': '0.54162'}; time used = 0.28876328468322754s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 450: {'train_loss': '0.53124'}; time used = 0.3093881607055664s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 455: {'train_loss': '0.52458'}; time used = 0.40880799293518066s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 460: {'train_loss': '0.52177'}; time used = 0.3177189826965332s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 465: {'train_loss': '0.66595'}; time used = 0.3510737419128418s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 470: {'train_loss': '0.59135'}; time used = 0.3458127975463867s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 475: {'train_loss': '0.57211'}; time used = 0.33498263359069824s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 480: {'train_loss': '0.54562'}; time used = 0.4803500175476074s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 485: {'train_loss': '0.52452'}; time used = 0.44289278984069824s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 490: {'train_loss': '0.51190'}; time used = 0.4118175506591797s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 495: {'train_loss': '0.49817'}; time used = 0.3276364803314209s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 500: {'train_loss': '0.49340'}; time used = 0.3193247318267822s
torch.int64
Finished training. Time used = 43.585904598236084.
Training classifier using 20.00% nodes...
{'micro': 0.48104089219330853, 'macro': 0.40024998001170503, 'samples': 0.4861006761833208, 'weighted': 0.4432066993925401}
  0%|          | 0/6654 [00:00<?, ?it/s]100%|██████████| 6654/6654 [00:00<00:00, 97939.02it/s]
actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 128, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.03, 'early_stopping': 20, 'hiddens': [128, 128], 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.025552034378051758 seconds.
Run epoch 1
Epoch 1 ends in 0.026506423950195312 seconds.
6654 sentences created
mode 1: time used = 0.07911276817321777
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 5: {'train_loss': '1.41566'}; time used = 0.3574821949005127s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 10: {'train_loss': '1.38629'}; time used = 0.3029823303222656s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 15: {'train_loss': '1.38284'}; time used = 0.2785346508026123s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 20: {'train_loss': '1.36300'}; time used = 0.3252241611480713s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 25: {'train_loss': '1.34995'}; time used = 0.28372955322265625s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 30: {'train_loss': '1.33849'}; time used = 0.2743651866912842s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 35: {'train_loss': '1.33188'}; time used = 0.3721332550048828s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 40: {'train_loss': '1.32740'}; time used = 0.27231764793395996s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 45: {'train_loss': '1.19806'}; time used = 0.42639851570129395s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 50: {'train_loss': '1.22343'}; time used = 0.2783172130584717s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 55: {'train_loss': '1.30759'}; time used = 0.32593417167663574s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 60: {'train_loss': '1.26479'}; time used = 0.26557040214538574s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 65: {'train_loss': '1.15937'}; time used = 0.26737093925476074s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 70: {'train_loss': '1.12238'}; time used = 0.2853431701660156s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 75: {'train_loss': '1.05130'}; time used = 0.2746443748474121s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 80: {'train_loss': '1.05300'}; time used = 0.30768299102783203s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 85: {'train_loss': '1.03944'}; time used = 0.2903735637664795s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 90: {'train_loss': '1.01788'}; time used = 0.27695703506469727s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 95: {'train_loss': '1.00478'}; time used = 0.26728034019470215s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 100: {'train_loss': '0.99841'}; time used = 0.3352224826812744s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 105: {'train_loss': '0.99292'}; time used = 0.2839515209197998s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 110: {'train_loss': '0.98589'}; time used = 0.2807168960571289s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 115: {'train_loss': '0.98196'}; time used = 0.267071008682251s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 120: {'train_loss': '0.97307'}; time used = 0.3746161460876465s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 125: {'train_loss': '0.97131'}; time used = 0.2771773338317871s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 130: {'train_loss': '0.97162'}; time used = 0.3492705821990967s
torch.int64
torch.int64
torch.int64
torch.int64
Early stopping condition satisfied. Abort training.
torch.int64
Finished training. Time used = 11.912361860275269.
Training classifier using 20.00% nodes...
{'micro': 0.33271375464684017, 'macro': 0.17750454418908468, 'samples': 0.33621337340345603, 'weighted': 0.20182434654288642}
  0%|          | 0/6654 [00:00<?, ?it/s] 73%|███████▎  | 4850/6654 [00:00<00:00, 48499.35it/s]100%|██████████| 6654/6654 [00:00<00:00, 49606.82it/s]
actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 128, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.001, 'early_stopping': 20, 'hiddens': [128, 128, 128], 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.04533219337463379 seconds.
Run epoch 1
Epoch 1 ends in 0.11223578453063965 seconds.
6654 sentences created
mode 1: time used = 0.16385722160339355
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 5: {'train_loss': '1.36532'}; time used = 0.9783034324645996s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 10: {'train_loss': '1.18372'}; time used = 1.1131165027618408s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 15: {'train_loss': '0.94085'}; time used = 1.0316417217254639s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 20: {'train_loss': '0.72879'}; time used = 0.9642832279205322s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 25: {'train_loss': '0.55945'}; time used = 0.958101749420166s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 30: {'train_loss': '0.42153'}; time used = 0.7961716651916504s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 35: {'train_loss': '0.33681'}; time used = 0.865760087966919s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 40: {'train_loss': '0.28041'}; time used = 0.7626922130584717s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 45: {'train_loss': '0.22595'}; time used = 0.8178601264953613s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 50: {'train_loss': '0.19875'}; time used = 0.8235738277435303s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 55: {'train_loss': '0.16530'}; time used = 0.8154070377349854s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 60: {'train_loss': '0.14921'}; time used = 0.9419054985046387s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 65: {'train_loss': '0.16277'}; time used = 0.8330650329589844s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 70: {'train_loss': '0.22867'}; time used = 0.8108603954315186s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 75: {'train_loss': '0.18374'}; time used = 0.9144783020019531s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 80: {'train_loss': '0.15551'}; time used = 0.8460607528686523s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 85: {'train_loss': '0.13128'}; time used = 0.832291841506958s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 90: {'train_loss': '0.11929'}; time used = 0.884289026260376s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 95: {'train_loss': '0.10844'}; time used = 0.9571256637573242s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 100: {'train_loss': '0.10361'}; time used = 0.8934705257415771s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 105: {'train_loss': '0.09262'}; time used = 0.3616042137145996s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 110: {'train_loss': '0.08847'}; time used = 0.2901136875152588s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 115: {'train_loss': '0.08599'}; time used = 0.27850937843322754s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 120: {'train_loss': '0.08186'}; time used = 0.3575725555419922s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 125: {'train_loss': '0.07779'}; time used = 0.3974018096923828s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 130: {'train_loss': '0.07475'}; time used = 0.33002448081970215s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 135: {'train_loss': '0.07344'}; time used = 0.31983256340026855s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 140: {'train_loss': '0.07454'}; time used = 0.29412293434143066s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 145: {'train_loss': '0.06885'}; time used = 0.28391361236572266s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 150: {'train_loss': '0.07008'}; time used = 0.35364866256713867s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 155: {'train_loss': '0.06647'}; time used = 0.36388421058654785s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 160: {'train_loss': '0.06571'}; time used = 0.3231685161590576s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 165: {'train_loss': '0.06340'}; time used = 0.37558603286743164s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 170: {'train_loss': '0.06190'}; time used = 0.2843360900878906s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 175: {'train_loss': '0.06002'}; time used = 0.2836012840270996s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 180: {'train_loss': '0.06040'}; time used = 0.29151487350463867s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 185: {'train_loss': '0.06075'}; time used = 0.35387277603149414s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 190: {'train_loss': '0.05914'}; time used = 0.4026467800140381s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 195: {'train_loss': '0.05990'}; time used = 0.43764472007751465s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 200: {'train_loss': '0.05636'}; time used = 0.49164366722106934s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 205: {'train_loss': '0.05701'}; time used = 0.4461486339569092s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 210: {'train_loss': '0.05978'}; time used = 0.45255565643310547s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 215: {'train_loss': '0.06612'}; time used = 0.3701045513153076s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 220: {'train_loss': '0.06360'}; time used = 0.3608412742614746s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 225: {'train_loss': '0.07924'}; time used = 0.3531758785247803s
torch.int64
Early stopping condition satisfied. Abort training.
torch.int64
Finished training. Time used = 42.124632358551025.
Training classifier using 20.00% nodes...
{'micro': 0.649814126394052, 'macro': 0.5611543733979536, 'samples': 0.6566491359879789, 'weighted': 0.6245401901531838}
  0%|          | 0/6654 [00:00<?, ?it/s] 68%|██████▊   | 4506/6654 [00:00<00:00, 45058.65it/s]100%|██████████| 6654/6654 [00:00<00:00, 46089.81it/s]actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 128, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.01, 'early_stopping': 20, 'hiddens': [128, 128, 128], 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.046315670013427734 seconds.
Run epoch 1
Epoch 1 ends in 0.04465675354003906 seconds.
6654 sentences created
mode 1: time used = 0.18500065803527832
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 5: {'train_loss': '1.37019'}; time used = 1.1058142185211182s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 10: {'train_loss': '1.37252'}; time used = 1.046480417251587s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 15: {'train_loss': '1.37834'}; time used = 1.2105331420898438s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 20: {'train_loss': '1.33962'}; time used = 1.008904218673706s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 25: {'train_loss': '1.20200'}; time used = 0.7491085529327393s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 30: {'train_loss': '1.17657'}; time used = 0.9018309116363525s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 35: {'train_loss': '1.07537'}; time used = 0.9023902416229248s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 40: {'train_loss': '1.05297'}; time used = 0.9615662097930908s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 45: {'train_loss': '1.06781'}; time used = 0.8137233257293701s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 50: {'train_loss': '1.01751'}; time used = 0.8648567199707031s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 55: {'train_loss': '0.99546'}; time used = 0.9329516887664795s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 60: {'train_loss': '0.97709'}; time used = 0.9325771331787109s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 65: {'train_loss': '0.96748'}; time used = 0.8507871627807617s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 70: {'train_loss': '0.95700'}; time used = 0.9073867797851562s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 75: {'train_loss': '0.94311'}; time used = 0.8416717052459717s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 80: {'train_loss': '0.93202'}; time used = 1.0735511779785156s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 85: {'train_loss': '0.96494'}; time used = 1.0244379043579102s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 90: {'train_loss': '0.88101'}; time used = 0.8836874961853027s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 95: {'train_loss': '0.83619'}; time used = 0.3173093795776367s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 100: {'train_loss': '0.89077'}; time used = 0.3945181369781494s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 105: {'train_loss': '0.85889'}; time used = 0.3049476146697998s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 110: {'train_loss': '0.90848'}; time used = 0.41805219650268555s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 115: {'train_loss': '0.91449'}; time used = 0.2988615036010742s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 120: {'train_loss': '0.79773'}; time used = 0.3048136234283447s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 125: {'train_loss': '0.76460'}; time used = 0.3993220329284668s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 130: {'train_loss': '0.72345'}; time used = 0.29995131492614746s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 135: {'train_loss': '0.69312'}; time used = 0.3537278175354004s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 140: {'train_loss': '0.92048'}; time used = 0.4118618965148926s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 145: {'train_loss': '0.81516'}; time used = 0.3028595447540283s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 150: {'train_loss': '0.69983'}; time used = 0.2973496913909912s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 155: {'train_loss': '0.67529'}; time used = 0.32626819610595703s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 160: {'train_loss': '0.69564'}; time used = 0.3885173797607422s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 165: {'train_loss': '0.65989'}; time used = 0.29869651794433594s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 170: {'train_loss': '0.61921'}; time used = 0.4301421642303467s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 175: {'train_loss': '0.55479'}; time used = 0.4180483818054199s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 180: {'train_loss': '0.56312'}; time used = 0.30475687980651855s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 185: {'train_loss': '0.64322'}; time used = 0.3784003257751465s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 190: {'train_loss': '0.76332'}; time used = 0.4298133850097656s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 195: {'train_loss': '0.71035'}; time used = 0.4188103675842285s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 200: {'train_loss': '0.62559'}; time used = 0.4353516101837158s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 205: {'train_loss': '0.55502'}; time used = 0.3587300777435303s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 210: {'train_loss': '0.51958'}; time used = 0.34472107887268066s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 215: {'train_loss': '0.49564'}; time used = 0.42821216583251953s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 220: {'train_loss': '0.50374'}; time used = 0.49689197540283203s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 225: {'train_loss': '0.47768'}; time used = 0.43376636505126953s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 230: {'train_loss': '0.58891'}; time used = 0.596261739730835s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 235: {'train_loss': '0.65218'}; time used = 0.8009257316589355s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 240: {'train_loss': '0.67500'}; time used = 0.799907922744751s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 245: {'train_loss': '0.56208'}; time used = 0.7322025299072266s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 250: {'train_loss': '0.52251'}; time used = 0.7032647132873535s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 255: {'train_loss': '0.54308'}; time used = 0.7516613006591797s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 260: {'train_loss': '0.92606'}; time used = 0.6760997772216797s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 265: {'train_loss': '0.61158'}; time used = 0.69887375831604s

torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 270: {'train_loss': '0.58110'}; time used = 0.7336647510528564s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 275: {'train_loss': '0.66627'}; time used = 0.823932409286499s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 280: {'train_loss': '0.71142'}; time used = 0.7525269985198975s
torch.int64
torch.int64
torch.int64
Early stopping condition satisfied. Abort training.
torch.int64
Finished training. Time used = 42.41601514816284.
Training classifier using 20.00% nodes...
{'micro': 0.4921933085501859, 'macro': 0.4306059975464622, 'samples': 0.4973703981968445, 'weighted': 0.4680780564416577}
  0%|          | 0/6654 [00:00<?, ?it/s]100%|██████████| 6654/6654 [00:00<00:00, 73683.94it/s]actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 128, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.02, 'early_stopping': 20, 'hiddens': [128, 128, 128], 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]])
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:5')
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.04254579544067383 seconds.
Run epoch 1
Epoch 1 ends in 0.04372000694274902 seconds.
6654 sentences created
mode 1: time used = 0.1167914867401123
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 5: {'train_loss': '1.40438'}; time used = 0.8058738708496094s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 10: {'train_loss': '1.38183'}; time used = 0.7467343807220459s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 15: {'train_loss': '1.35657'}; time used = 0.8326430320739746s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 20: {'train_loss': '1.35420'}; time used = 0.7911105155944824s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 25: {'train_loss': '1.33229'}; time used = 0.9500057697296143s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 30: {'train_loss': '1.17208'}; time used = 0.9649279117584229s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 35: {'train_loss': '0.99215'}; time used = 0.9416341781616211s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 40: {'train_loss': '0.87078'}; time used = 0.8454198837280273s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 45: {'train_loss': '0.97194'}; time used = 0.9376125335693359s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 50: {'train_loss': '1.04754'}; time used = 0.7408223152160645s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 55: {'train_loss': '1.01089'}; time used = 0.9495337009429932s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 60: {'train_loss': '1.14492'}; time used = 0.8534069061279297s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 65: {'train_loss': '1.02209'}; time used = 0.8024590015411377s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 70: {'train_loss': '0.90340'}; time used = 0.8201851844787598s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 75: {'train_loss': '1.03611'}; time used = 0.7893002033233643s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 80: {'train_loss': '1.03372'}; time used = 0.7864384651184082s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 85: {'train_loss': '1.31010'}; time used = 0.8680102825164795s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 90: {'train_loss': '0.92210'}; time used = 0.711716890335083s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 95: {'train_loss': '0.94982'}; time used = 0.9442296028137207s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 100: {'train_loss': '0.82582'}; time used = 0.8561019897460938s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 105: {'train_loss': '0.72838'}; time used = 0.8550095558166504s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 110: {'train_loss': '0.63918'}; time used = 0.8167891502380371s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 115: {'train_loss': '0.76551'}; time used = 0.7342603206634521s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 120: {'train_loss': '0.96011'}; time used = 0.7777342796325684s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 125: {'train_loss': '1.01615'}; time used = 0.7569422721862793s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 130: {'train_loss': '0.88830'}; time used = 0.2891883850097656s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 135: {'train_loss': '0.84799'}; time used = 0.3371307849884033s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 140: {'train_loss': '0.74643'}; time used = 0.3125782012939453s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 145: {'train_loss': '0.64476'}; time used = 0.3199031352996826s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 150: {'train_loss': '0.59439'}; time used = 0.2761800289154053s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 155: {'train_loss': '0.57531'}; time used = 0.2903769016265869s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 160: {'train_loss': '0.56233'}; time used = 0.2815537452697754s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 165: {'train_loss': '0.58504'}; time used = 0.28881335258483887s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 170: {'train_loss': '0.54675'}; time used = 0.29439234733581543s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 175: {'train_loss': '0.52497'}; time used = 0.28090643882751465s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 180: {'train_loss': '0.49242'}; time used = 0.27968668937683105s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 185: {'train_loss': '0.47303'}; time used = 0.28700852394104004s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 190: {'train_loss': '0.53442'}; time used = 0.31760358810424805s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 195: {'train_loss': '0.57604'}; time used = 0.276411771774292s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 200: {'train_loss': '0.56602'}; time used = 0.2899501323699951s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 205: {'train_loss': '0.54696'}; time used = 0.28437089920043945s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 210: {'train_loss': '1.09057'}; time used = 0.2939260005950928s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 215: {'train_loss': '0.73705'}; time used = 0.28702402114868164s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 220: {'train_loss': '0.68773'}; time used = 0.28432273864746094s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 225: {'train_loss': '0.58215'}; time used = 0.3035132884979248s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 230: {'train_loss': '0.59389'}; time used = 0.2830948829650879s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 235: {'train_loss': '0.55300'}; time used = 0.2827897071838379s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 240: {'train_loss': '0.56834'}; time used = 0.3083477020263672s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 245: {'train_loss': '0.52604'}; time used = 0.28847837448120117s

torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 250: {'train_loss': '0.48262'}; time used = 0.29399776458740234s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 255: {'train_loss': '0.46962'}; time used = 0.2846834659576416s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 260: {'train_loss': '0.44297'}; time used = 0.2957730293273926s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 265: {'train_loss': '0.41807'}; time used = 0.39856410026550293s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 270: {'train_loss': '0.54317'}; time used = 0.8146176338195801s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 275: {'train_loss': '0.58857'}; time used = 0.8048453330993652s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 280: {'train_loss': '0.52550'}; time used = 0.7360777854919434s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 285: {'train_loss': '0.48048'}; time used = 0.8838262557983398s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 290: {'train_loss': '0.46814'}; time used = 0.8491034507751465s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 295: {'train_loss': '0.42836'}; time used = 0.8480203151702881s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 300: {'train_loss': '0.52829'}; time used = 1.0712144374847412s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 305: {'train_loss': '0.47792'}; time used = 0.8479392528533936s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 310: {'train_loss': '0.43484'}; time used = 0.8114066123962402s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 315: {'train_loss': '0.55674'}; time used = 0.7698550224304199s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 320: {'train_loss': '0.58521'}; time used = 0.7357063293457031s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 325: {'train_loss': '0.76651'}; time used = 0.806992769241333s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 330: {'train_loss': '0.65714'}; time used = 0.7128293514251709s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 335: {'train_loss': '0.76625'}; time used = 0.890815258026123s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 340: {'train_loss': '0.70571'}; time used = 0.8165638446807861s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 345: {'train_loss': '0.59454'}; time used = 0.8325448036193848s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 350: {'train_loss': '0.56689'}; time used = 0.7760930061340332s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 355: {'train_loss': '0.51261'}; time used = 0.6948673725128174s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 360: {'train_loss': '0.50202'}; time used = 0.7003557682037354s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 365: {'train_loss': '0.47323'}; time used = 0.6794025897979736s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 370: {'train_loss': '0.45617'}; time used = 0.7554936408996582s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 375: {'train_loss': '0.59346'}; time used = 0.7291548252105713s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 380: {'train_loss': '0.48349'}; time used = 0.7190587520599365s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 385: {'train_loss': '0.51582'}; time used = 0.7606618404388428s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 390: {'train_loss': '0.50323'}; time used = 0.761223316192627s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 395: {'train_loss': '0.46162'}; time used = 0.7823395729064941s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 400: {'train_loss': '0.43449'}; time used = 0.8433141708374023s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 405: {'train_loss': '0.47814'}; time used = 0.7457501888275146s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 410: {'train_loss': '0.48381'}; time used = 0.7988340854644775s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 415: {'train_loss': '0.46520'}; time used = 0.7014846801757812s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 420: {'train_loss': '0.44386'}; time used = 0.9745650291442871s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 425: {'train_loss': '0.41218'}; time used = 0.912517786026001s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 430: {'train_loss': '0.40261'}; time used = 1.1088342666625977s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 435: {'train_loss': '0.39529'}; time used = 1.264319896697998s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 440: {'train_loss': '0.37795'}; time used = 1.1497411727905273s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 445: {'train_loss': '0.37284'}; time used = 1.0433855056762695s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 450: {'train_loss': '0.37356'}; time used = 1.3438806533813477s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 455: {'train_loss': '0.56326'}; time used = 1.1148922443389893s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 460: {'train_loss': '0.47984'}; time used = 1.0704500675201416s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 465: {'train_loss': '0.52494'}; time used = 1.038001537322998s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 470: {'train_loss': '0.57374'}; time used = 1.321533203125s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 475: {'train_loss': '0.52868'}; time used = 1.045020341873169s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 480: {'train_loss': '0.47982'}; time used = 1.137303113937378s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 485: {'train_loss': '0.44826'}; time used = 1.0616881847381592s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 490: {'train_loss': '0.42516'}; time used = 1.0361452102661133s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 495: {'train_loss': '0.40213'}; time used = 0.9400718212127686s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 500: {'train_loss': '0.38896'}; time used = 1.1453347206115723s
torch.int64
Finished training. Time used = 83.03694939613342.
Training classifier using 20.00% nodes...
{'micro': 0.46059479553903343, 'macro': 0.35932016720032545, 'samples': 0.46543951915852744, 'weighted': 0.3864446078747069}
  0%|          | 0/6654 [00:00<?, ?it/s]100%|██████████| 6654/6654 [00:00<00:00, 77984.61it/s]actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 128, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.03, 'early_stopping': 20, 'hiddens': [128, 128, 128], 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]])
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:5')
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.08563494682312012 seconds.
Run epoch 1
Epoch 1 ends in 0.07213854789733887 seconds.
6654 sentences created
mode 1: time used = 0.10533380508422852
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 5: {'train_loss': '1.42698'}; time used = 0.9483110904693604s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 10: {'train_loss': '1.40320'}; time used = 0.9344727993011475s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 15: {'train_loss': '1.44755'}; time used = 0.777446985244751s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 20: {'train_loss': '1.38119'}; time used = 0.8353183269500732s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 25: {'train_loss': '1.37481'}; time used = 0.872727632522583s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 30: {'train_loss': '1.36255'}; time used = 0.7980048656463623s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 35: {'train_loss': '1.32074'}; time used = 0.8045675754547119s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 40: {'train_loss': '1.27390'}; time used = 0.8219335079193115s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 45: {'train_loss': '1.14727'}; time used = 0.8121669292449951s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 50: {'train_loss': '1.08353'}; time used = 0.8496761322021484s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 55: {'train_loss': '1.03390'}; time used = 0.826810359954834s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 60: {'train_loss': '0.99206'}; time used = 0.788891077041626s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 65: {'train_loss': '0.95436'}; time used = 0.8572678565979004s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 70: {'train_loss': '0.94615'}; time used = 0.8870205879211426s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 75: {'train_loss': '0.89508'}; time used = 0.7747101783752441s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 80: {'train_loss': '0.87106'}; time used = 0.9040939807891846s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 85: {'train_loss': '0.93357'}; time used = 0.8019657135009766s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 90: {'train_loss': '0.93902'}; time used = 0.8050925731658936s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 95: {'train_loss': '0.96257'}; time used = 0.8065094947814941s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 100: {'train_loss': '0.84768'}; time used = 0.8450751304626465s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 105: {'train_loss': '0.80844'}; time used = 0.7829880714416504s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 110: {'train_loss': '0.76861'}; time used = 0.7704117298126221s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 115: {'train_loss': '0.73740'}; time used = 0.38353848457336426s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 120: {'train_loss': '0.87289'}; time used = 0.29256701469421387s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 125: {'train_loss': '0.80022'}; time used = 0.40299510955810547s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 130: {'train_loss': '0.76730'}; time used = 0.3511691093444824s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 135: {'train_loss': '0.75742'}; time used = 0.4224209785461426s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 140: {'train_loss': '0.73794'}; time used = 0.34354472160339355s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 145: {'train_loss': '0.69333'}; time used = 0.2897186279296875s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 150: {'train_loss': '0.66724'}; time used = 0.3784058094024658s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 155: {'train_loss': '0.65460'}; time used = 0.3271811008453369s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 160: {'train_loss': '0.75774'}; time used = 0.315532922744751s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 165: {'train_loss': '0.73099'}; time used = 0.2972407341003418s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 170: {'train_loss': '0.68810'}; time used = 0.2771909236907959s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 175: {'train_loss': '0.64778'}; time used = 0.29509758949279785s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 180: {'train_loss': '0.62992'}; time used = 0.2823922634124756s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 185: {'train_loss': '0.61190'}; time used = 0.2739064693450928s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 190: {'train_loss': '0.64561'}; time used = 0.2844583988189697s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 195: {'train_loss': '0.62804'}; time used = 0.28282809257507324s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 200: {'train_loss': '0.61675'}; time used = 0.35115599632263184s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 205: {'train_loss': '0.59998'}; time used = 0.2794644832611084s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 210: {'train_loss': '0.56940'}; time used = 0.2667562961578369s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 215: {'train_loss': '0.56383'}; time used = 0.2660844326019287s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 220: {'train_loss': '0.82986'}; time used = 0.26750779151916504s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 225: {'train_loss': '0.77329'}; time used = 0.3372817039489746s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 230: {'train_loss': '0.72455'}; time used = 0.2837257385253906s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 235: {'train_loss': '0.64675'}; time used = 0.3274571895599365s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 240: {'train_loss': '0.63210'}; time used = 0.2716379165649414s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 245: {'train_loss': '0.60004'}; time used = 0.27236342430114746s

torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 250: {'train_loss': '0.58240'}; time used = 0.2665128707885742s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 255: {'train_loss': '0.56990'}; time used = 0.27137017250061035s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 260: {'train_loss': '0.60652'}; time used = 0.2990412712097168s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 265: {'train_loss': '0.83837'}; time used = 0.2928757667541504s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 270: {'train_loss': '0.90120'}; time used = 0.32749104499816895s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 275: {'train_loss': '0.81727'}; time used = 0.3038332462310791s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 280: {'train_loss': '0.77643'}; time used = 0.3236043453216553s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 285: {'train_loss': '0.73567'}; time used = 0.27214813232421875s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 290: {'train_loss': '0.69179'}; time used = 0.32433176040649414s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 295: {'train_loss': '0.66516'}; time used = 0.28324031829833984s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 300: {'train_loss': '0.64590'}; time used = 0.44498252868652344s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 305: {'train_loss': '0.64904'}; time used = 0.8087735176086426s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 310: {'train_loss': '0.63587'}; time used = 0.8125641345977783s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 315: {'train_loss': '0.60367'}; time used = 0.788977861404419s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 320: {'train_loss': '0.58834'}; time used = 0.9376060962677002s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 325: {'train_loss': '0.57000'}; time used = 0.7709648609161377s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 330: {'train_loss': '0.59141'}; time used = 0.7795095443725586s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 335: {'train_loss': '0.55987'}; time used = 0.8783352375030518s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 340: {'train_loss': '0.56574'}; time used = 0.8541128635406494s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 345: {'train_loss': '0.55506'}; time used = 0.7336020469665527s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 350: {'train_loss': '0.56197'}; time used = 0.7443327903747559s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 355: {'train_loss': '0.60158'}; time used = 0.8243570327758789s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 360: {'train_loss': '0.65662'}; time used = 0.877662181854248s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 365: {'train_loss': '0.60204'}; time used = 0.772407054901123s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 370: {'train_loss': '0.58816'}; time used = 0.8553862571716309s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 375: {'train_loss': '0.56012'}; time used = 0.7709529399871826s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 380: {'train_loss': '0.58276'}; time used = 0.813159704208374s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 385: {'train_loss': '0.57741'}; time used = 0.8002710342407227s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 390: {'train_loss': '0.59991'}; time used = 0.7392241954803467s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 395: {'train_loss': '0.57755'}; time used = 0.8272387981414795s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 400: {'train_loss': '0.54731'}; time used = 0.8701255321502686s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 405: {'train_loss': '0.52385'}; time used = 0.7473611831665039s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 410: {'train_loss': '0.52830'}; time used = 0.8807969093322754s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 415: {'train_loss': '0.51976'}; time used = 1.2401456832885742s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 420: {'train_loss': '0.54925'}; time used = 1.3170456886291504s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 425: {'train_loss': '0.55268'}; time used = 1.7357466220855713s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 430: {'train_loss': '0.81311'}; time used = 1.2441956996917725s
torch.int64
torch.int64
torch.int64
torch.int64
torch.int64
epoch 435: {'train_loss': '0.93993'}; time used = 1.523413896560669s
Early stopping condition satisfied. Abort training.
torch.int64
Finished training. Time used = 61.894429206848145.
Training classifier using 20.00% nodes...
{'micro': 0.33345724907063196, 'macro': 0.19100944951461774, 'samples': 0.3369646882043576, 'weighted': 0.230989838096859}
  0%|          | 0/6654 [00:00<?, ?it/s]100%|██████████| 6654/6654 [00:00<00:00, 203530.37it/s]
Traceback (most recent call last):
  File "/usr/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/duyufeng/OpenNE/src/openne/__main__.py", line 265, in <module>
    main(parse_args())
  File "/home/duyufeng/OpenNE/src/openne/__main__.py", line 249, in main
    res = task.train(model, graph)  # train
  File "/home/duyufeng/OpenNE/src/openne/tasks/tasks.py", line 35, in train
    res = model(graph, **self.train_kwargs())
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/duyufeng/OpenNE/src/openne/models/models.py", line 236, in forward
    self.embeddings = self.train_model(graph, step=i, **kwargs)
  File "/home/duyufeng/OpenNE/src/openne/models/ss_nodemodel.py", line 114, in train_model
    output, train_loss, __ = self.evaluate()
  File "/home/duyufeng/OpenNE/src/openne/models/ss_nodemodel.py", line 156, in evaluate
    loss.backward()
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/tensor.py", line 185, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/autograd/__init__.py", line 127, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA out of memory. Tried to allocate 22.74 GiB (GPU 5; 10.76 GiB total capacity; 506.85 MiB already allocated; 8.45 GiB free; 534.00 MiB reserved in total by PyTorch)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:272 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7f8a74b261e2 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x1e64b (0x7f8a94d9f64b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #2: <unknown function> + 0x1f464 (0x7f8a94da0464 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #3: <unknown function> + 0x1faa1 (0x7f8a94da0aa1 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #4: at::native::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0x11e (0x7f8833d1190e in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #5: <unknown function> + 0xf33949 (0x7f883214b949 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xf4d777 (0x7f8832165777 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0x10e9c7d (0x7f886cf01c7d in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #8: <unknown function> + 0x10e9f97 (0x7f886cf01f97 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #9: at::empty(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0xfa (0x7f886d00ca1a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::TensorIterator::allocate_outputs() + 0x378 (0x7f886cc9c4f8 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::TensorIterator::build(at::TensorIteratorConfig&) + 0x1e6 (0x7f886cc9e166 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #12: at::TensorIterator::TensorIterator(at::TensorIteratorConfig&) + 0xdd (0x7f886cc9e65d in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #13: at::TensorIterator::binary_op(at::Tensor&, at::Tensor const&, at::Tensor const&, bool) + 0x14a (0x7f886cc9e80a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #14: at::native::mul(at::Tensor const&, at::Tensor const&) + 0x47 (0x7f886c9dbeb7 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0xf22b40 (0x7f883213ab40 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #16: <unknown function> + 0xa56530 (0x7f886c86e530 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #17: at::Tensor c10::Dispatcher::call<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, at::Tensor const&)> const&, at::Tensor const&, at::Tensor const&) const + 0xbc (0x7f886d05681c in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #18: at::mul(at::Tensor const&, at::Tensor const&) + 0x4b (0x7f886cfa782b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #19: <unknown function> + 0xcc6952 (0x7f886cade952 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #20: at::native::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0xdba (0x7f886cadff4a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #21: <unknown function> + 0x129b8c0 (0x7f886d0b38c0 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #22: <unknown function> + 0x12c508b (0x7f886d0dd08b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #23: at::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0x1d7 (0x7f886d004337 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #24: <unknown function> + 0x2dfa205 (0x7f886ec12205 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #25: <unknown function> + 0x12c508b (0x7f886d0dd08b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #26: at::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0x1d7 (0x7f886d004337 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #27: torch::autograd::generated::TrilinearBackward::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&) + 0x6a8 (0x7f886eb71f78 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #28: <unknown function> + 0x3375bb7 (0x7f886f18dbb7 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #29: torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&) + 0x1400 (0x7f886f189400 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #30: torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&) + 0x451 (0x7f886f189fa1 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #31: torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x89 (0x7f886f182119 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #32: torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x4a (0x7f8a958fb4ba in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_python.so)
frame #33: <unknown function> + 0xbd6df (0x7f8a96a576df in /usr/lib/x86_64-linux-gnu/libstdc++.so.6)
frame #34: <unknown function> + 0x76db (0x7f8a9aab26db in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #35: clone + 0x3f (0x7f8a9adeb71f in /lib/x86_64-linux-gnu/libc.so.6)

actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 256, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.001, 'early_stopping': 20, 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:5')
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:5')
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.019196510314941406 seconds.
Run epoch 1
Epoch 1 ends in 0.018941640853881836 seconds.
6654 sentences created
mode 1: time used = 0.0411224365234375
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
  0%|          | 0/6654 [00:00<?, ?it/s] 63%|██████▎   | 4194/6654 [00:00<00:00, 41937.34it/s]100%|██████████| 6654/6654 [00:00<00:00, 42118.44it/s]
Traceback (most recent call last):
  File "/usr/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/duyufeng/OpenNE/src/openne/__main__.py", line 265, in <module>
    main(parse_args())
  File "/home/duyufeng/OpenNE/src/openne/__main__.py", line 249, in main
    res = task.train(model, graph)  # train
  File "/home/duyufeng/OpenNE/src/openne/tasks/tasks.py", line 35, in train
    res = model(graph, **self.train_kwargs())
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/duyufeng/OpenNE/src/openne/models/models.py", line 236, in forward
    self.embeddings = self.train_model(graph, step=i, **kwargs)
  File "/home/duyufeng/OpenNE/src/openne/models/ss_nodemodel.py", line 114, in train_model
    output, train_loss, __ = self.evaluate()
  File "/home/duyufeng/OpenNE/src/openne/models/ss_nodemodel.py", line 156, in evaluate
    loss.backward()
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/tensor.py", line 185, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/autograd/__init__.py", line 127, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA out of memory. Tried to allocate 22.74 GiB (GPU 5; 10.76 GiB total capacity; 506.85 MiB already allocated; 8.45 GiB free; 534.00 MiB reserved in total by PyTorch)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:272 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7f764833e1e2 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x1e64b (0x7f764859464b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #2: <unknown function> + 0x1f464 (0x7f7648595464 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #3: <unknown function> + 0x1faa1 (0x7f7648595aa1 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #4: at::native::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0x11e (0x7f73ee37390e in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #5: <unknown function> + 0xf33949 (0x7f73ec7ad949 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xf4d777 (0x7f73ec7c7777 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0x10e9c7d (0x7f7427563c7d in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #8: <unknown function> + 0x10e9f97 (0x7f7427563f97 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #9: at::empty(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0xfa (0x7f742766ea1a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::TensorIterator::allocate_outputs() + 0x378 (0x7f74272fe4f8 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::TensorIterator::build(at::TensorIteratorConfig&) + 0x1e6 (0x7f7427300166 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #12: at::TensorIterator::TensorIterator(at::TensorIteratorConfig&) + 0xdd (0x7f742730065d in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #13: at::TensorIterator::binary_op(at::Tensor&, at::Tensor const&, at::Tensor const&, bool) + 0x14a (0x7f742730080a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #14: at::native::mul(at::Tensor const&, at::Tensor const&) + 0x47 (0x7f742703deb7 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0xf22b40 (0x7f73ec79cb40 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #16: <unknown function> + 0xa56530 (0x7f7426ed0530 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #17: at::Tensor c10::Dispatcher::call<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, at::Tensor const&)> const&, at::Tensor const&, at::Tensor const&) const + 0xbc (0x7f74276b881c in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #18: at::mul(at::Tensor const&, at::Tensor const&) + 0x4b (0x7f742760982b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #19: <unknown function> + 0xcc6952 (0x7f7427140952 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #20: at::native::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0xdba (0x7f7427141f4a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #21: <unknown function> + 0x129b8c0 (0x7f74277158c0 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #22: <unknown function> + 0x12c508b (0x7f742773f08b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #23: at::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0x1d7 (0x7f7427666337 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #24: <unknown function> + 0x2dfa205 (0x7f7429274205 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #25: <unknown function> + 0x12c508b (0x7f742773f08b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #26: at::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0x1d7 (0x7f7427666337 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #27: torch::autograd::generated::TrilinearBackward::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&) + 0x6a8 (0x7f74291d3f78 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #28: <unknown function> + 0x3375bb7 (0x7f74297efbb7 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #29: torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&) + 0x1400 (0x7f74297eb400 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #30: torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&) + 0x451 (0x7f74297ebfa1 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #31: torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x89 (0x7f74297e4119 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #32: torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x4a (0x7f751e71c4ba in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_python.so)
frame #33: <unknown function> + 0xbd6df (0x7f76510b96df in /usr/lib/x86_64-linux-gnu/libstdc++.so.6)
frame #34: <unknown function> + 0x76db (0x7f76551146db in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #35: clone + 0x3f (0x7f765544d71f in /lib/x86_64-linux-gnu/libc.so.6)

actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 256, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.01, 'early_stopping': 20, 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:5')
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:5')
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.11901283264160156 seconds.
Run epoch 1
Epoch 1 ends in 0.11781764030456543 seconds.
6654 sentences created
mode 1: time used = 0.18975210189819336
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
  0%|          | 0/6654 [00:00<?, ?it/s] 76%|███████▌  | 5069/6654 [00:00<00:00, 50686.91it/s]100%|██████████| 6654/6654 [00:00<00:00, 46274.36it/s]
Traceback (most recent call last):
  File "/usr/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/duyufeng/OpenNE/src/openne/__main__.py", line 265, in <module>
    main(parse_args())
  File "/home/duyufeng/OpenNE/src/openne/__main__.py", line 249, in main
    res = task.train(model, graph)  # train
  File "/home/duyufeng/OpenNE/src/openne/tasks/tasks.py", line 35, in train
    res = model(graph, **self.train_kwargs())
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/duyufeng/OpenNE/src/openne/models/models.py", line 236, in forward
    self.embeddings = self.train_model(graph, step=i, **kwargs)
  File "/home/duyufeng/OpenNE/src/openne/models/ss_nodemodel.py", line 114, in train_model
    output, train_loss, __ = self.evaluate()
  File "/home/duyufeng/OpenNE/src/openne/models/ss_nodemodel.py", line 156, in evaluate
    loss.backward()
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/tensor.py", line 185, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/autograd/__init__.py", line 127, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA out of memory. Tried to allocate 22.74 GiB (GPU 5; 10.76 GiB total capacity; 506.85 MiB already allocated; 8.45 GiB free; 534.00 MiB reserved in total by PyTorch)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:272 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7fa0fd2051e2 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x1e64b (0x7fa0fd45b64b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #2: <unknown function> + 0x1f464 (0x7fa0fd45c464 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #3: <unknown function> + 0x1faa1 (0x7fa0fd45caa1 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #4: at::native::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0x11e (0x7f9ebc74f90e in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #5: <unknown function> + 0xf33949 (0x7f9ebab89949 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xf4d777 (0x7f9ebaba3777 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0x10e9c7d (0x7fa0fe757c7d in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #8: <unknown function> + 0x10e9f97 (0x7fa0fe757f97 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #9: at::empty(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0xfa (0x7fa0fe862a1a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::TensorIterator::allocate_outputs() + 0x378 (0x7fa0fe4f24f8 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::TensorIterator::build(at::TensorIteratorConfig&) + 0x1e6 (0x7fa0fe4f4166 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #12: at::TensorIterator::TensorIterator(at::TensorIteratorConfig&) + 0xdd (0x7fa0fe4f465d in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #13: at::TensorIterator::binary_op(at::Tensor&, at::Tensor const&, at::Tensor const&, bool) + 0x14a (0x7fa0fe4f480a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #14: at::native::mul(at::Tensor const&, at::Tensor const&) + 0x47 (0x7fa0fe231eb7 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0xf22b40 (0x7f9ebab78b40 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #16: <unknown function> + 0xa56530 (0x7fa0fe0c4530 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #17: at::Tensor c10::Dispatcher::call<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, at::Tensor const&)> const&, at::Tensor const&, at::Tensor const&) const + 0xbc (0x7fa0fe8ac81c in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #18: at::mul(at::Tensor const&, at::Tensor const&) + 0x4b (0x7fa0fe7fd82b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #19: <unknown function> + 0xcc6952 (0x7fa0fe334952 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #20: at::native::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0xdba (0x7fa0fe335f4a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #21: <unknown function> + 0x129b8c0 (0x7fa0fe9098c0 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #22: <unknown function> + 0x12c508b (0x7fa0fe93308b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #23: at::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0x1d7 (0x7fa0fe85a337 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #24: <unknown function> + 0x2dfa205 (0x7fa100468205 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #25: <unknown function> + 0x12c508b (0x7fa0fe93308b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #26: at::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0x1d7 (0x7fa0fe85a337 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #27: torch::autograd::generated::TrilinearBackward::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&) + 0x6a8 (0x7fa1003c7f78 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #28: <unknown function> + 0x3375bb7 (0x7fa1009e3bb7 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #29: torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&) + 0x1400 (0x7fa1009df400 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #30: torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&) + 0x451 (0x7fa1009dffa1 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #31: torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x89 (0x7fa1009d8119 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #32: torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x4a (0x7fa10e1784ba in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_python.so)
frame #33: <unknown function> + 0xbd6df (0x7fa10f2d46df in /usr/lib/x86_64-linux-gnu/libstdc++.so.6)
frame #34: <unknown function> + 0x76db (0x7fa11332f6db in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #35: clone + 0x3f (0x7fa11366871f in /lib/x86_64-linux-gnu/libc.so.6)

actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 256, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.02, 'early_stopping': 20, 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:5')
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:5')
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.03582954406738281 seconds.
Run epoch 1
Epoch 1 ends in 0.06534647941589355 seconds.
6654 sentences created
mode 1: time used = 0.176849365234375
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
  0%|          | 0/6654 [00:00<?, ?it/s] 72%|███████▏  | 4760/6654 [00:00<00:00, 47596.30it/s]100%|██████████| 6654/6654 [00:00<00:00, 54789.94it/s]
Traceback (most recent call last):
  File "/usr/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/duyufeng/OpenNE/src/openne/__main__.py", line 265, in <module>
    main(parse_args())
  File "/home/duyufeng/OpenNE/src/openne/__main__.py", line 249, in main
    res = task.train(model, graph)  # train
  File "/home/duyufeng/OpenNE/src/openne/tasks/tasks.py", line 35, in train
    res = model(graph, **self.train_kwargs())
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/duyufeng/OpenNE/src/openne/models/models.py", line 236, in forward
    self.embeddings = self.train_model(graph, step=i, **kwargs)
  File "/home/duyufeng/OpenNE/src/openne/models/ss_nodemodel.py", line 114, in train_model
    output, train_loss, __ = self.evaluate()
  File "/home/duyufeng/OpenNE/src/openne/models/ss_nodemodel.py", line 156, in evaluate
    loss.backward()
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/tensor.py", line 185, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/autograd/__init__.py", line 127, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA out of memory. Tried to allocate 22.74 GiB (GPU 5; 10.76 GiB total capacity; 506.85 MiB already allocated; 8.45 GiB free; 534.00 MiB reserved in total by PyTorch)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:272 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7fe2edd671e2 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x1e64b (0x7fe2edfbd64b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #2: <unknown function> + 0x1f464 (0x7fe2edfbe464 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #3: <unknown function> + 0x1faa1 (0x7fe2edfbeaa1 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #4: at::native::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0x11e (0x7fe0ad2b190e in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #5: <unknown function> + 0xf33949 (0x7fe0ab6eb949 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xf4d777 (0x7fe0ab705777 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0x10e9c7d (0x7fe2ef2b9c7d in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #8: <unknown function> + 0x10e9f97 (0x7fe2ef2b9f97 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #9: at::empty(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0xfa (0x7fe2ef3c4a1a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::TensorIterator::allocate_outputs() + 0x378 (0x7fe2ef0544f8 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::TensorIterator::build(at::TensorIteratorConfig&) + 0x1e6 (0x7fe2ef056166 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #12: at::TensorIterator::TensorIterator(at::TensorIteratorConfig&) + 0xdd (0x7fe2ef05665d in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #13: at::TensorIterator::binary_op(at::Tensor&, at::Tensor const&, at::Tensor const&, bool) + 0x14a (0x7fe2ef05680a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #14: at::native::mul(at::Tensor const&, at::Tensor const&) + 0x47 (0x7fe2eed93eb7 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0xf22b40 (0x7fe0ab6dab40 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #16: <unknown function> + 0xa56530 (0x7fe2eec26530 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #17: at::Tensor c10::Dispatcher::call<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, at::Tensor const&)> const&, at::Tensor const&, at::Tensor const&) const + 0xbc (0x7fe2ef40e81c in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #18: at::mul(at::Tensor const&, at::Tensor const&) + 0x4b (0x7fe2ef35f82b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #19: <unknown function> + 0xcc6952 (0x7fe2eee96952 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #20: at::native::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0xdba (0x7fe2eee97f4a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #21: <unknown function> + 0x129b8c0 (0x7fe2ef46b8c0 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #22: <unknown function> + 0x12c508b (0x7fe2ef49508b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #23: at::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0x1d7 (0x7fe2ef3bc337 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #24: <unknown function> + 0x2dfa205 (0x7fe2f0fca205 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #25: <unknown function> + 0x12c508b (0x7fe2ef49508b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #26: at::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0x1d7 (0x7fe2ef3bc337 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #27: torch::autograd::generated::TrilinearBackward::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&) + 0x6a8 (0x7fe2f0f29f78 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #28: <unknown function> + 0x3375bb7 (0x7fe2f1545bb7 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #29: torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&) + 0x1400 (0x7fe2f1541400 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #30: torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&) + 0x451 (0x7fe2f1541fa1 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #31: torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x89 (0x7fe2f153a119 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #32: torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x4a (0x7fe2fecda4ba in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_python.so)
frame #33: <unknown function> + 0xbd6df (0x7fe2ffe366df in /usr/lib/x86_64-linux-gnu/libstdc++.so.6)
frame #34: <unknown function> + 0x76db (0x7fe303e916db in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #35: clone + 0x3f (0x7fe3041ca71f in /lib/x86_64-linux-gnu/libc.so.6)

actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 256, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.03, 'early_stopping': 20, 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:5')
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:5')
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.1314222812652588 seconds.
Run epoch 1
Epoch 1 ends in 0.05529356002807617 seconds.
6654 sentences created
mode 1: time used = 0.14753460884094238
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
  0%|          | 0/6654 [00:00<?, ?it/s] 94%|█████████▍| 6275/6654 [00:00<00:00, 58968.29it/s]100%|██████████| 6654/6654 [00:00<00:00, 55576.37it/s]
Traceback (most recent call last):
  File "/usr/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/duyufeng/OpenNE/src/openne/__main__.py", line 265, in <module>
    main(parse_args())
  File "/home/duyufeng/OpenNE/src/openne/__main__.py", line 249, in main
    res = task.train(model, graph)  # train
  File "/home/duyufeng/OpenNE/src/openne/tasks/tasks.py", line 35, in train
    res = model(graph, **self.train_kwargs())
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/duyufeng/OpenNE/src/openne/models/models.py", line 236, in forward
    self.embeddings = self.train_model(graph, step=i, **kwargs)
  File "/home/duyufeng/OpenNE/src/openne/models/ss_nodemodel.py", line 114, in train_model
    output, train_loss, __ = self.evaluate()
  File "/home/duyufeng/OpenNE/src/openne/models/ss_nodemodel.py", line 156, in evaluate
    loss.backward()
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/tensor.py", line 185, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/autograd/__init__.py", line 127, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA out of memory. Tried to allocate 22.74 GiB (GPU 5; 10.76 GiB total capacity; 513.60 MiB already allocated; 8.45 GiB free; 534.00 MiB reserved in total by PyTorch)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:272 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7fd66812b1e2 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x1e64b (0x7fd66838164b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #2: <unknown function> + 0x1f464 (0x7fd668382464 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #3: <unknown function> + 0x1faa1 (0x7fd668382aa1 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #4: at::native::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0x11e (0x7fd42767590e in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #5: <unknown function> + 0xf33949 (0x7fd425aaf949 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xf4d777 (0x7fd425ac9777 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0x10e9c7d (0x7fd66967dc7d in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #8: <unknown function> + 0x10e9f97 (0x7fd66967df97 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #9: at::empty(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0xfa (0x7fd669788a1a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::TensorIterator::allocate_outputs() + 0x378 (0x7fd6694184f8 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::TensorIterator::build(at::TensorIteratorConfig&) + 0x1e6 (0x7fd66941a166 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #12: at::TensorIterator::TensorIterator(at::TensorIteratorConfig&) + 0xdd (0x7fd66941a65d in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #13: at::TensorIterator::binary_op(at::Tensor&, at::Tensor const&, at::Tensor const&, bool) + 0x14a (0x7fd66941a80a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #14: at::native::mul(at::Tensor const&, at::Tensor const&) + 0x47 (0x7fd669157eb7 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0xf22b40 (0x7fd425a9eb40 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #16: <unknown function> + 0xa56530 (0x7fd668fea530 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #17: at::Tensor c10::Dispatcher::call<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, at::Tensor const&)> const&, at::Tensor const&, at::Tensor const&) const + 0xbc (0x7fd6697d281c in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #18: at::mul(at::Tensor const&, at::Tensor const&) + 0x4b (0x7fd66972382b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #19: <unknown function> + 0xcc6952 (0x7fd66925a952 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #20: at::native::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0xdba (0x7fd66925bf4a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #21: <unknown function> + 0x129b8c0 (0x7fd66982f8c0 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #22: <unknown function> + 0x12c508b (0x7fd66985908b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #23: at::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0x1d7 (0x7fd669780337 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #24: <unknown function> + 0x2dfa205 (0x7fd66b38e205 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #25: <unknown function> + 0x12c508b (0x7fd66985908b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #26: at::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0x1d7 (0x7fd669780337 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #27: torch::autograd::generated::TrilinearBackward::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&) + 0x6a8 (0x7fd66b2edf78 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #28: <unknown function> + 0x3375bb7 (0x7fd66b909bb7 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #29: torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&) + 0x1400 (0x7fd66b905400 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #30: torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&) + 0x451 (0x7fd66b905fa1 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #31: torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x89 (0x7fd66b8fe119 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #32: torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x4a (0x7fd67909e4ba in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_python.so)
frame #33: <unknown function> + 0xbd6df (0x7fd67a1fa6df in /usr/lib/x86_64-linux-gnu/libstdc++.so.6)
frame #34: <unknown function> + 0x76db (0x7fd67e2556db in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #35: clone + 0x3f (0x7fd67e58e71f in /lib/x86_64-linux-gnu/libc.so.6)

actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 256, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.001, 'early_stopping': 20, 'hiddens': [256], 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:5')
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:5')
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.04701375961303711 seconds.
Run epoch 1
Epoch 1 ends in 0.043055057525634766 seconds.
6654 sentences created
mode 1: time used = 0.16393280029296875
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
  0%|          | 0/6654 [00:00<?, ?it/s]100%|██████████| 6654/6654 [00:00<00:00, 86136.98it/s]
Traceback (most recent call last):
  File "/usr/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/duyufeng/OpenNE/src/openne/__main__.py", line 265, in <module>
    main(parse_args())
  File "/home/duyufeng/OpenNE/src/openne/__main__.py", line 249, in main
    res = task.train(model, graph)  # train
  File "/home/duyufeng/OpenNE/src/openne/tasks/tasks.py", line 35, in train
    res = model(graph, **self.train_kwargs())
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/duyufeng/OpenNE/src/openne/models/models.py", line 236, in forward
    self.embeddings = self.train_model(graph, step=i, **kwargs)
  File "/home/duyufeng/OpenNE/src/openne/models/ss_nodemodel.py", line 114, in train_model
    output, train_loss, __ = self.evaluate()
  File "/home/duyufeng/OpenNE/src/openne/models/ss_nodemodel.py", line 156, in evaluate
    loss.backward()
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/tensor.py", line 185, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/autograd/__init__.py", line 127, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA out of memory. Tried to allocate 22.74 GiB (GPU 5; 10.76 GiB total capacity; 513.60 MiB already allocated; 8.45 GiB free; 534.00 MiB reserved in total by PyTorch)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:272 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7f46b6fe21e2 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x1e64b (0x7f46b723864b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #2: <unknown function> + 0x1f464 (0x7f46b7239464 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #3: <unknown function> + 0x1faa1 (0x7f46b7239aa1 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #4: at::native::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0x11e (0x7f447652c90e in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #5: <unknown function> + 0xf33949 (0x7f4474966949 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xf4d777 (0x7f4474980777 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0x10e9c7d (0x7f46b8534c7d in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #8: <unknown function> + 0x10e9f97 (0x7f46b8534f97 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #9: at::empty(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0xfa (0x7f46b863fa1a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::TensorIterator::allocate_outputs() + 0x378 (0x7f46b82cf4f8 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::TensorIterator::build(at::TensorIteratorConfig&) + 0x1e6 (0x7f46b82d1166 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #12: at::TensorIterator::TensorIterator(at::TensorIteratorConfig&) + 0xdd (0x7f46b82d165d in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #13: at::TensorIterator::binary_op(at::Tensor&, at::Tensor const&, at::Tensor const&, bool) + 0x14a (0x7f46b82d180a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #14: at::native::mul(at::Tensor const&, at::Tensor const&) + 0x47 (0x7f46b800eeb7 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0xf22b40 (0x7f4474955b40 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #16: <unknown function> + 0xa56530 (0x7f46b7ea1530 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #17: at::Tensor c10::Dispatcher::call<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, at::Tensor const&)> const&, at::Tensor const&, at::Tensor const&) const + 0xbc (0x7f46b868981c in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #18: at::mul(at::Tensor const&, at::Tensor const&) + 0x4b (0x7f46b85da82b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #19: <unknown function> + 0xcc6952 (0x7f46b8111952 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #20: at::native::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0xdba (0x7f46b8112f4a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #21: <unknown function> + 0x129b8c0 (0x7f46b86e68c0 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #22: <unknown function> + 0x12c508b (0x7f46b871008b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #23: at::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0x1d7 (0x7f46b8637337 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #24: <unknown function> + 0x2dfa205 (0x7f46ba245205 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #25: <unknown function> + 0x12c508b (0x7f46b871008b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #26: at::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0x1d7 (0x7f46b8637337 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #27: torch::autograd::generated::TrilinearBackward::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&) + 0x6a8 (0x7f46ba1a4f78 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #28: <unknown function> + 0x3375bb7 (0x7f46ba7c0bb7 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #29: torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&) + 0x1400 (0x7f46ba7bc400 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #30: torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&) + 0x451 (0x7f46ba7bcfa1 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #31: torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x89 (0x7f46ba7b5119 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #32: torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x4a (0x7f46c7f554ba in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_python.so)
frame #33: <unknown function> + 0xbd6df (0x7f46c90b16df in /usr/lib/x86_64-linux-gnu/libstdc++.so.6)
frame #34: <unknown function> + 0x76db (0x7f46cd10c6db in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #35: clone + 0x3f (0x7f46cd44571f in /lib/x86_64-linux-gnu/libc.so.6)

actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 256, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.01, 'early_stopping': 20, 'hiddens': [256], 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:5')
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:5')
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.04527902603149414 seconds.
Run epoch 1
Epoch 1 ends in 0.04363131523132324 seconds.
6654 sentences created
mode 1: time used = 0.09606075286865234
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
  0%|          | 0/6654 [00:00<?, ?it/s]100%|██████████| 6654/6654 [00:00<00:00, 175174.01it/s]
Traceback (most recent call last):
  File "/usr/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/duyufeng/OpenNE/src/openne/__main__.py", line 265, in <module>
    main(parse_args())
  File "/home/duyufeng/OpenNE/src/openne/__main__.py", line 249, in main
    res = task.train(model, graph)  # train
  File "/home/duyufeng/OpenNE/src/openne/tasks/tasks.py", line 35, in train
    res = model(graph, **self.train_kwargs())
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/duyufeng/OpenNE/src/openne/models/models.py", line 236, in forward
    self.embeddings = self.train_model(graph, step=i, **kwargs)
  File "/home/duyufeng/OpenNE/src/openne/models/ss_nodemodel.py", line 114, in train_model
    output, train_loss, __ = self.evaluate()
  File "/home/duyufeng/OpenNE/src/openne/models/ss_nodemodel.py", line 156, in evaluate
    loss.backward()
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/tensor.py", line 185, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/autograd/__init__.py", line 127, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA out of memory. Tried to allocate 22.74 GiB (GPU 5; 10.76 GiB total capacity; 513.60 MiB already allocated; 8.45 GiB free; 534.00 MiB reserved in total by PyTorch)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:272 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7fc47e4a61e2 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x1e64b (0x7fc47e6fc64b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #2: <unknown function> + 0x1f464 (0x7fc47e6fd464 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #3: <unknown function> + 0x1faa1 (0x7fc47e6fdaa1 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #4: at::native::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0x11e (0x7fc21d66e90e in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #5: <unknown function> + 0xf33949 (0x7fc21baa8949 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xf4d777 (0x7fc21bac2777 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0x10e9c7d (0x7fc25685ec7d in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #8: <unknown function> + 0x10e9f97 (0x7fc25685ef97 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #9: at::empty(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0xfa (0x7fc256969a1a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::TensorIterator::allocate_outputs() + 0x378 (0x7fc2565f94f8 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::TensorIterator::build(at::TensorIteratorConfig&) + 0x1e6 (0x7fc2565fb166 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #12: at::TensorIterator::TensorIterator(at::TensorIteratorConfig&) + 0xdd (0x7fc2565fb65d in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #13: at::TensorIterator::binary_op(at::Tensor&, at::Tensor const&, at::Tensor const&, bool) + 0x14a (0x7fc2565fb80a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #14: at::native::mul(at::Tensor const&, at::Tensor const&) + 0x47 (0x7fc256338eb7 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0xf22b40 (0x7fc21ba97b40 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #16: <unknown function> + 0xa56530 (0x7fc2561cb530 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #17: at::Tensor c10::Dispatcher::call<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, at::Tensor const&)> const&, at::Tensor const&, at::Tensor const&) const + 0xbc (0x7fc2569b381c in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #18: at::mul(at::Tensor const&, at::Tensor const&) + 0x4b (0x7fc25690482b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #19: <unknown function> + 0xcc6952 (0x7fc25643b952 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #20: at::native::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0xdba (0x7fc25643cf4a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #21: <unknown function> + 0x129b8c0 (0x7fc256a108c0 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #22: <unknown function> + 0x12c508b (0x7fc256a3a08b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #23: at::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0x1d7 (0x7fc256961337 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #24: <unknown function> + 0x2dfa205 (0x7fc25856f205 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #25: <unknown function> + 0x12c508b (0x7fc256a3a08b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #26: at::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0x1d7 (0x7fc256961337 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #27: torch::autograd::generated::TrilinearBackward::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&) + 0x6a8 (0x7fc2584cef78 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #28: <unknown function> + 0x3375bb7 (0x7fc258aeabb7 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #29: torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&) + 0x1400 (0x7fc258ae6400 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #30: torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&) + 0x451 (0x7fc258ae6fa1 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #31: torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x89 (0x7fc258adf119 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #32: torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x4a (0x7fc47f2584ba in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_python.so)
frame #33: <unknown function> + 0xbd6df (0x7fc4803b46df in /usr/lib/x86_64-linux-gnu/libstdc++.so.6)
frame #34: <unknown function> + 0x76db (0x7fc48440f6db in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #35: clone + 0x3f (0x7fc48474871f in /lib/x86_64-linux-gnu/libc.so.6)

actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 256, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.02, 'early_stopping': 20, 'hiddens': [256], 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:5')
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:5')
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.02417469024658203 seconds.
Run epoch 1
Epoch 1 ends in 0.022831439971923828 seconds.
6654 sentences created
mode 1: time used = 0.04729771614074707
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
  0%|          | 0/6654 [00:00<?, ?it/s]100%|██████████| 6654/6654 [00:00<00:00, 213907.19it/s]
Traceback (most recent call last):
  File "/usr/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/duyufeng/OpenNE/src/openne/__main__.py", line 265, in <module>
    main(parse_args())
  File "/home/duyufeng/OpenNE/src/openne/__main__.py", line 249, in main
    res = task.train(model, graph)  # train
  File "/home/duyufeng/OpenNE/src/openne/tasks/tasks.py", line 35, in train
    res = model(graph, **self.train_kwargs())
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/duyufeng/OpenNE/src/openne/models/models.py", line 236, in forward
    self.embeddings = self.train_model(graph, step=i, **kwargs)
  File "/home/duyufeng/OpenNE/src/openne/models/ss_nodemodel.py", line 114, in train_model
    output, train_loss, __ = self.evaluate()
  File "/home/duyufeng/OpenNE/src/openne/models/ss_nodemodel.py", line 156, in evaluate
    loss.backward()
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/tensor.py", line 185, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/duyufeng/.local/lib/python3.6/site-packages/torch/autograd/__init__.py", line 127, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA out of memory. Tried to allocate 22.74 GiB (GPU 5; 10.76 GiB total capacity; 513.60 MiB already allocated; 8.45 GiB free; 534.00 MiB reserved in total by PyTorch)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:272 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7f7d4126d1e2 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x1e64b (0x7f7d5169564b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #2: <unknown function> + 0x1f464 (0x7f7d51696464 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #3: <unknown function> + 0x1faa1 (0x7f7d51696aa1 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #4: at::native::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0x11e (0x7f7aef45690e in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #5: <unknown function> + 0xf33949 (0x7f7aed890949 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xf4d777 (0x7f7aed8aa777 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0x10e9c7d (0x7f7b28646c7d in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #8: <unknown function> + 0x10e9f97 (0x7f7b28646f97 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #9: at::empty(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0xfa (0x7f7b28751a1a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::TensorIterator::allocate_outputs() + 0x378 (0x7f7b283e14f8 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::TensorIterator::build(at::TensorIteratorConfig&) + 0x1e6 (0x7f7b283e3166 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #12: at::TensorIterator::TensorIterator(at::TensorIteratorConfig&) + 0xdd (0x7f7b283e365d in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #13: at::TensorIterator::binary_op(at::Tensor&, at::Tensor const&, at::Tensor const&, bool) + 0x14a (0x7f7b283e380a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #14: at::native::mul(at::Tensor const&, at::Tensor const&) + 0x47 (0x7f7b28120eb7 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0xf22b40 (0x7f7aed87fb40 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #16: <unknown function> + 0xa56530 (0x7f7b27fb3530 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #17: at::Tensor c10::Dispatcher::call<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, at::Tensor const&)> const&, at::Tensor const&, at::Tensor const&) const + 0xbc (0x7f7b2879b81c in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #18: at::mul(at::Tensor const&, at::Tensor const&) + 0x4b (0x7f7b286ec82b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #19: <unknown function> + 0xcc6952 (0x7f7b28223952 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #20: at::native::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0xdba (0x7f7b28224f4a in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #21: <unknown function> + 0x129b8c0 (0x7f7b287f88c0 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #22: <unknown function> + 0x12c508b (0x7f7b2882208b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #23: at::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0x1d7 (0x7f7b28749337 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #24: <unknown function> + 0x2dfa205 (0x7f7b2a357205 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #25: <unknown function> + 0x12c508b (0x7f7b2882208b in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #26: at::_trilinear(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ArrayRef<long>, long) + 0x1d7 (0x7f7b28749337 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #27: torch::autograd::generated::TrilinearBackward::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&) + 0x6a8 (0x7f7b2a2b6f78 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #28: <unknown function> + 0x3375bb7 (0x7f7b2a8d2bb7 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #29: torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&) + 0x1400 (0x7f7b2a8ce400 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #30: torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&) + 0x451 (0x7f7b2a8cefa1 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #31: torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x89 (0x7f7b2a8c7119 in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #32: torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x4a (0x7f7c9600c4ba in /home/duyufeng/.local/lib/python3.6/site-packages/torch/lib/libtorch_python.so)
frame #33: <unknown function> + 0xbd6df (0x7f7d5219c6df in /usr/lib/x86_64-linux-gnu/libstdc++.so.6)
frame #34: <unknown function> + 0x76db (0x7f7d561f76db in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #35: clone + 0x3f (0x7f7d5653071f in /lib/x86_64-linux-gnu/libc.so.6)

actual args: {'cpu': False, 'devices': [5], 'model': 'ss_nodemodel', 'dataset': 'citeseer', 'local_dataset': False, 'name': 'SelfDefined', 'weighted': False, 'directed': False, 'clf_ratio': 0.2, '_validate': False, '_no_validate': False, 'dim': 256, 'epochs': 500, 'validation_interval': 5, 'debug_output_interval': 5, 'save': False, 'silent': False, 'sparse': False, 'lr': 0.03, 'early_stopping': 20, 'hiddens': [256], 'kstep': 4, 'measurement': 'katz', 'table_size': 100000000.0, 'encoder_layer_list': [128], 'nu1': 1e-08, 'nu2': 0.0001, 'decay': False, 'pretrain': False, 'lamb': 0.4, 'enc': 'linear', 'dec': 'bilinear', 'sampler': 'node-rand_walk-random', 'readout': 'mean', 'est': 'jsd'}
Loading CiteSeer Dataset from root dir: /home/duyufeng/OpenNE/data/CiteSeer
Executing task UnsupervisedNodeClassification.
Creating test set using 20.0% nodes as training set...finished
Start training...
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:5')
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:5')
encoder = linear
generating anchors and positive samples...
5 2 2
Walk iteration:
Run epoch 0
Epoch 0 ends in 0.017619609832763672 seconds.
Run epoch 1
Epoch 1 ends in 0.01713395118713379 seconds.
6654 sentences created
mode 1: time used = 0.03918766975402832
anchors and positive samples of len 93156 generated
repeating 1 times...
generating negative samples with random...
negative samples generated
sampler length = 93156 93156 93156
total iter: 500
torch.int64
